<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[windows ä¸‹ cronolog è¿›è¡Œæ—¥å¿—åˆ‡å‰²]]></title>
    <url>%2F2020%2F06%2F03%2FJava%2Fcronolog-win%2F</url>
    <content type="text"><![CDATA[è½¯ä»¶åŒ…ä¸‹è½½åœ°å€1é“¾æŽ¥: https://pan.baidu.com/s/1xhhBKCthOxZuYBhEL4pb-Q æå–ç : 9mxj jar åŒ…æ—¥å¿—åˆ†å‰² ä»¥ springboot çš„jarä¸ºä¾‹ï¼Œå…¶ä»– jar åŒ…ç±»ä¼¼ windows çŽ¯å¢ƒ ä»Žä¸Šè¿°åœ°å€ðŸ‘†ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„ cronolog åŒ… è§£åŽ‹å­˜æ”¾åˆ°æŒ‡å®šç›®å½•ï¼Œä¾‹å¦‚ d:\cronolog æ‰§è¡Œ jar å¯åŠ¨å‘½ä»¤ 1java -jar xxx.jar | d:\cronolog\cronolog.exe æ—¥å¿—è¾“å‡ºè·¯å¾„\xxx-%%Y%%m%%d.log è¦æ˜¯æƒ³åŽç«¯è¿è¡Œå¯ä»¥ç¼–å†™batå¯åŠ¨è„šæœ¬ 12345@echo offjavaw -jar xxx.jar | d:\cronolog\cronolog.exe æ—¥å¿—è¾“å‡ºè·¯å¾„\xxx-%%Y%%m%%d.logexit linux çŽ¯å¢ƒ ä¸‹è½½å®‰è£…åŒ… cronolog-1.6.2.tar.gz 123wget http://cronolog.org/download/cronolog-1.6.2.tar.gz # æˆ–è€…wget https://files.cnblogs.com/files/crazyzero/cronolog-1.6.2.tar.gz è§£åŽ‹ 1tar zxvf cronolog-1.6.2.tar.gz å®‰è£… 1234cd cronolog-1.6.2./configuremakesudo make install éªŒè¯ 12which cronolog# è¾“å‡º /usr/local/sbin/cronolog æ‰§è¡Œ jar å¯åŠ¨å‘½ä»¤ 1java -jar xxx.jar | /usr/local/sbin/cronolog æ—¥å¿—è¾“å‡ºè·¯å¾„\xxx-%Y%m%d.log è¦æ˜¯æƒ³åŽç«¯è¿è¡Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ 1nohub java -jar xxx.jar | /usr/local/sbin/cronolog æ—¥å¿—è¾“å‡ºè·¯å¾„\xxx-%Y%m%d.log &amp; tomcat è¿›è¡Œæ—¥å¿—åˆ†å‰² è¿™ä¸ªå†…å®¹ç½‘ä¸Šå¾ˆå¤šèµ„æºï¼Œåœ¨æ­¤ä¸å±•å¼€è¯´ï¼Œä¾‹å¦‚ï¼šhttps://blog.csdn.net/fly910905/article/details/78528652]]></content>
      <categories>
        <category>Java</category>
        <category>cronolog</category>
      </categories>
      <tags>
        <tag>log</tag>
        <tag>cronolog</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows Server 2016 æ­å»º FTP]]></title>
    <url>%2F2020%2F02%2F12%2Fwindows%2Fwindows_server_2016_ftp%2F</url>
    <content type="text"><![CDATA[å®‰è£… WEB æœåŠ¡å™¨é€šè¿‡æœåŠ¡å™¨æ·»åŠ è§’è‰²å’ŒåŠŸèƒ½å‘å¯¼æ·»åŠ  Web æœåŠ¡å™¨(IIS) æœåŠ¡å™¨ç®¡ç†å™¨ â€”â€” æ·»åŠ è§’è‰²åŠŸèƒ½ â€”â€” Web æœåŠ¡å™¨(IIS) ä¸‹ä¸€æ­¥ ä¸‹ä¸€æ­¥ ä¸‹ä¸€æ­¥ é€‰æ‹© ftp å¹¶ä¸”ç‚¹å‡»ä¸‹ä¸€æ­¥ å®‰è£… å…³é—­ æ·»åŠ  FTP ç«™ç‚¹åœ¨ è®¡ç®—æœºç®¡ç† ä¸­æ ¹æ®æç¤ºæ·»åŠ å³å¯ å¡«å†™è‡ªå®šä¹‰ä¿¡æ¯ï¼Œä¸‹ä¸€æ­¥ å¡«å†™ä¿¡æ¯ï¼Œä¸‹ä¸€æ­¥ æ ¹æ®éœ€è¦é…ç½®æƒé™ä¿¡æ¯ æ‰“å¼€IEæµè§ˆå™¨ï¼Œåœ¨Internet é€‰é¡¹ ä¸­è®¾ç½® ä½¿ç”¨è¢«åŠ¨ FTP é˜²ç«å¢™å¼€æ”¾ç«¯å£åœ¨æœåŠ¡å™¨ç®¡ç†ä¸­æ‰“å¼€ é«˜çº§å®‰å…¨ Windows é˜²ç«å¢™ï¼Œç‚¹å‡» å…¥ç«™è§„åˆ™ â€”â€” æ–°å»ºè§„åˆ™ï¼Œæ ¹æ®æç¤ºæ·»åŠ è¿œç¨‹ç«¯å£ï¼ˆé»˜è®¤ä¸º21ç«¯å£ï¼‰ï¼Œå»ºè®®å°†ç«¯å£è®¾ç½®ä¸ºéž 21 ç«¯å£ã€‚ ç™»å½•éªŒè¯åœ¨windowsèµ„æºç®¡ç†å™¨ä¸­è¾“å…¥ä»¥ä¸‹åœ°å€å³å¯ç™»é™†ï¼š 1ftp://ipåœ°å€:ç«¯å£ æˆ–è€… 1ftp://username:password@ipåœ°å€:ç«¯å£ å‚è€ƒWindows Server 2016 æ­å»º FTPçŽ¯å¢ƒ]]></content>
      <categories>
        <category>windows</category>
        <category>ftp</category>
      </categories>
      <tags>
        <tag>windows server</tag>
        <tag>windows server 2016</tag>
        <tag>ftp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ä½¿ç”¨ webservice å¤‡ä»½æŠ¥è¡¨ catalog å¯¹è±¡]]></title>
    <url>%2F2019%2F08%2F24%2Foracle-cloud%2Fwebservice%2Fbackup-catalog-object%2F</url>
    <content type="text"><![CDATA[æ‰‹åŠ¨å¤‡ä»½å¦‚æžœä¸æ˜¯ç»å¸¸éœ€è¦è¿›è¡Œå¤‡ä»½å¯ä»¥é€šè¿‡æ‰‹åŠ¨è¿›è¡Œå¤‡ä»½ï¼Œæ²¡å¿…è¦é€šè¿‡ webservice å¤‡ä»½ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ‰‹åŠ¨æ“ä½œ BIP: Downloading and Uploading Catalog Objects OBIEE: Archiving Objects ps: è¿›å…¥BI Publisher https://xxx.com/xmlpserver webservice å¤‡ä»½å…¶å®žåªæ˜¯ç”¨ webservice çš„æ–¹å¼è¿›è¡Œ BIP å¤‡ä»½çš„ä¸¤æ­¥æ“ä½œ ä¸»è¦ä½¿ç”¨ webservice: https://xxx.com/xmlpserver/services/v2/CatalogService?wsdl ä¸­çš„ downloadObject å’Œ uploadObject æˆ–è€… updateObject é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ downloadObject, èŽ·å– catalog objects ç„¶åŽæ‰‹åŠ¨é€šè¿‡ BIP ç•Œé¢ä¸Šä¼ è¿˜åŽŸå³å¯å®Œæˆæ•´ä¸ªå¤‡ä»½è¿˜åŽŸæµç¨‹äº†ã€‚ç®€å•ä»‹ç»ä¸€ä¸‹æµç¨‹ è¯·æ±‚æŠ¥æ–‡ 123456789&lt;Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"&gt; &lt;Body&gt; &lt;downloadObject xmlns="http://xmlns.oracle.com/oxp/service/v2"&gt; &lt;reportAbsolutePath&gt;/Custom/Financials/General Ledger&lt;/reportAbsolutePath&gt; &lt;userID&gt;****&lt;/userID&gt; &lt;password&gt;***&lt;/password&gt; &lt;/downloadObject&gt; &lt;/Body&gt;&lt;/Envelope&gt; reportAbsolutePath: æŠ¥è¡¨è·¯å¾„ï¼Œå‡è®¾æˆ‘ä»¬è¦å¤‡ä»½å…±äº«ç›®å½•å®¢åˆ¶åŒ–çš„ /Custom/Financials/General Ledger ç›®å½•ï¼Œå¡«å†™ /Custom/Financials/General Ledger userIDï¼šç”¨æˆ·å password: å¯†ç  å“åº”æŠ¥æ–‡ é€šè¿‡èŽ·å–çš„ base64binary Code è§£å¯†ç”Ÿæˆæ–‡ä»¶å°±å®Œæˆäº†æ–‡ä»¶å¤‡ä»½çš„æ­¥éª¤äº† æµ‹è¯•çš„è¯å¯ä»¥é€šè¿‡ https://www.hitoy.org/tool/file_base64.php åœ¨çº¿å¯¹ base64binary Code è½¬æ¢æˆæ–‡ä»¶ï¼Œè¿™é‡Œä¸‹è½½çš„æ˜¯æ–‡ä»¶å¤¹å› æ­¤åŽç¼€åå†™ xdrz, åŽç¼€åå¯¹åº”è¯·å¾€ä¸‹çœ‹ æ–‡ä»¶åŽç¼€åç¡®å®šcatalog å¯¹è±¡æ–‡ä»¶åŽç¼€åçš„å¯¹åº”å¦‚ä¸‹ï¼Œåœ¨è½¬æ–‡ä»¶æ—¶éœ€è¦ä½¿ç”¨æ­£ç¡®çš„åŽç¼€åï¼Œä¸ç„¶ BIP ä¸Šä¼ è¿˜åŽŸæŠ¥é”™ Catalog Object Extension Assigned to Downloaded Files Data Model .xdmz Folder .xdrz Report .xdoz Style Template .xssz Subtemplate .xsbz BIP ä¸Šä¼  catalog å¯¹è±¡è¿›è¡Œè¿˜åŽŸè¾“å…¥ç½‘å€ https://xxx.com/xmlpserver è¿›å…¥ BIP ç•Œé¢ è¿›å…¥ catalog ç®¡ç†ç•Œé¢ï¼Œä¸‹å›¾ä¸¤ä¸ªæ¡†æ¡†ä½ç½®éƒ½å¯ä»¥è¿›å…¥ è¿›å…¥è¦è¿˜åŽŸåˆ°çš„ç›®å½•ä¸‹è¿›è¡Œä»¥ä¸‹æ“ä½œ è¿˜åŽŸæˆåŠŸ æµ‹è¯•ç»“æžœåˆ†æžåŽæœŸæµ‹è¯•å‘çŽ°ï¼Œä¸‹è½½çš„æ–‡ä»¶å¤¹ï¼Œå¦‚æžœé‡Œé¢çš„å†…å®¹è¿‡å¤šï¼ˆçŒœæµ‹æ˜¯æ–‡ä»¶å¤¹è¿‡å¤šï¼‰ä¼šå¯¼è‡´uploadçš„æ—¶å€™å¤±è´¥ï¼ŒåŽŸå› æœªæ˜Žï¼Œå¦å¤–å‘çŽ°é€šè¿‡ä¸‹è½½ä¸Šä¼ çš„æ–¹å¼æ— æ³•ä¿ç•™åŽŸæ–‡ä»¶çš„æƒé™ç­‰è®¾ç½®ã€‚å› æ­¤ï¼Œæ„Ÿè§‰å¦‚éžå¿…è¦è¿˜æ˜¯é€šè¿‡ OBIEE æ–¹å¼è¿›è¡Œå¤‡ä»½å§ï¼ˆä¹Ÿå°±æ˜¯å½’æ¡£ä¸Žåå½’æ¡£ï¼‰]]></content>
      <categories>
        <category>Oracle Cloud</category>
        <category>webservice</category>
      </categories>
      <tags>
        <tag>Oracle Cloud</tag>
        <tag>catalog</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[oracle cloud ç”¨æˆ·è§’è‰²æƒé™è¡¨å…³ç³»ï¼ˆåºŸå¼ƒï¼‰]]></title>
    <url>%2F2019%2F08%2F23%2Foracle-cloud%2Fuser-role-privilege%2F</url>
    <content type="text"><![CDATA[æ ¹æ® sr å›žå¤ï¼Œaseç›¸å…³è¡¨åªæ˜¯ç»™ oracle å†…éƒ¨ä½¿ç”¨ï¼Œè¡¨çš„æ•°æ®å¹¶ä¸å‡†ç¡®ï¼ŒåŽæœŸå¦‚æžœæœ‰æ‰¾åˆ°ç›¸å…³è¡¨å†åšæ›´æ–°å§ï¼Œå¤§å®¶çœ‹åˆ°è¿™ä¸ªç›´æŽ¥å¿½ç•¥å§ï¼Œæ‰“æ‰°äº† Cloud æŸ¥çœ‹ç”¨æˆ·è§’è‰²æƒé™ è¡¨å…³ç³»ä¸»è¦æ¶‰åŠè¡¨ï¼š å‰ç¼€ASEå¼€å¤´çš„ ASE_USER_VL ç”¨æˆ·è¡¨ ASE_USER_ROLE_MBR ç”¨æˆ·è§’è‰²åˆ†é…è¡¨ ASE_ROLE_VL è§’è‰²è¡¨ ASE_PRIVILEGE_VL æƒé™è¡¨ ASE_PRIV_ROLE_MBR æƒé™è§’è‰²è¡¨ ASE_ROLE_ROLE_MBR è§’è‰²çˆ¶å­å…³ç³»è¡¨ sql æŸ¥è¯¢è§’è‰²çˆ¶å­å…³ç³»12345678910111213141516SELECT t.parent_role_id, pr.code AS parent_role_code, pr.role_name AS parent_role_name, t.leaf, t.ase_role_id, r.code AS role_code, r.role_name FROM (SELECT parent_role_id, connect_by_isleaf leaf, connect_by_root(child_role_id) ase_role_id FROM ase_role_role_mbr CONNECT BY PRIOR ase_role_role_mbr.parent_role_id = ase_role_role_mbr.child_role_id) t, ase_role_vl pr, ase_role_vl r WHERE t.parent_role_id = pr.role_id(+) AND t.ase_role_id = r.role_id ç”¨æˆ·è§’è‰²æŸ¥è¯¢123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107WITH-- è§’è‰²çˆ¶å­å…³ç³»role_role_mbr_ AS (SELECT t.parent_role_id, pr.code AS parent_role_code, pr.role_name AS parent_role_name, t.leaf, t.ase_role_id, r.code AS role_code, r.role_name FROM (SELECT parent_role_id, connect_by_isleaf leaf, connect_by_root(child_role_id) ase_role_id FROM ase_role_role_mbr CONNECT BY PRIOR ase_role_role_mbr.parent_role_id = ase_role_role_mbr.child_role_id) t, ase_role_vl pr, ase_role_vl r WHERE t.parent_role_id = pr.role_id(+) AND t.ase_role_id = r.role_id),-- ç”¨æˆ·è§’è‰²user_role_ AS (SELECT u.user_login, u.user_display_name, -- ä¸Žå½“å‰æ—¥æœŸæ¯”è¾ƒåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆ decode((SELECT 1 FROM dual WHERE (u.effective_start_date &lt;= SYSDATE OR u.effective_start_date IS NULL) AND (u.effective_end_date &gt;= SYSDATE OR u.effective_end_date IS NULL) -- ä½¿ç”¨suspend åˆ¤æ–­æ˜¯å¦å¤±æ•ˆ AND EXISTS (SELECT 1 FROM per_users pu WHERE pu.user_guid = u.user_guid AND pu.suspended = 'N')), 1, 'Active', 'Inactive') AS is_user_active, u.creation_date AS user_creation_date, u.last_update_date AS user_last_update_date, r.role_id, r.code AS role_code, r.role_name, -- ä¸Žå½“å‰æ—¥æœŸæ¯”è¾ƒåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆ decode((SELECT 1 FROM dual WHERE (r.effective_start_date &lt;= SYSDATE OR r.effective_start_date IS NULL) AND (r.effective_end_date &gt;= SYSDATE OR r.effective_end_date IS NULL)), 1, 'Active', 'Inactive') AS is_role_active, r.creation_date AS role_creation_date, r.last_update_date AS role_last_update_date, -- ä¸Žå½“å‰æ—¥æœŸæ¯”è¾ƒåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆ decode((SELECT 1 FROM dual WHERE (ur.effective_start_date &lt;= SYSDATE OR ur.effective_start_date IS NULL) AND (ur.effective_end_date &gt;= SYSDATE OR ur.effective_end_date IS NULL)), 1, 'Active', 'Inactive') AS is_user_role_active, ur.creation_date AS user_role_creation_date, ur.last_update_date AS user_role_last_update_date FROM fusion.ase_user_vl u, fusion.ase_user_role_mbr ur, fusion.ase_role_vl r WHERE u.user_id = ur.user_id AND r.role_id = ur.role_id)-- ä¸»æŸ¥è¯¢SELECT t.user_login, t.user_display_name, t.is_user_active, t.user_creation_date, t.user_last_update_date, t.role_code, t.role_name, rr.parent_role_code, rr.parent_role_name, t.is_role_active, t.role_creation_date, t.role_last_update_date, t.is_user_role_active, t.user_role_creation_date, t.user_role_last_update_date FROM user_role_ t, role_role_mbr_ rr WHERE t.role_id = rr.ase_role_id(+) /* å‚æ•° */ -- ç”¨æˆ·ç™»é™†å AND (t.user_login = :p_user OR :p_user IS NULL) -- è§’è‰²ç¼–ç ï¼ŒåŒ…å«çˆ¶è§’è‰² AND (:p_role_code IS NULL OR t.role_code = :p_role_code OR rr.parent_role_code = :p_role_code) -- ç”¨æˆ·æ˜¯å¦æœ‰æ•ˆ AND (t.is_user_active = :p_user_active OR :p_user_active IS NULL) -- è§’è‰²æ˜¯å¦æœ‰æ•ˆ AND (t.is_role_active = :p_role_active OR :p_role_active IS NULL) -- ç”¨æˆ·è§’è‰²åˆ†é…æ˜¯å¦æœ‰æ•ˆ AND (t.is_user_role_active = :p_user_role_active OR :p_user_role_active IS NULL) -- ç”¨æˆ·åˆ›å»ºæ—¶é—´ AND (t.user_creation_date &gt;= :p_user_creation_date_from OR :p_user_creation_date_from IS NULL) AND (t.user_creation_date &lt;= :p_user_creation_date_to OR :p_user_creation_date_to IS NULL) -- è§’è‰²åˆ›å»ºæ—¶é—´ AND (t.role_creation_date &gt;= :p_role_creation_date_from OR :p_role_creation_date_from IS NULL) AND (t.role_creation_date &lt;= :p_role_creation_date_to OR :p_role_creation_date_to IS NULL) -- ç”¨æˆ·è§’è‰²åˆ›å»ºæ—¶é—´ AND (t.user_role_creation_date &gt;= :p_ur_creation_date_from OR :p_ur_creation_date_from IS NULL) AND (t.user_role_creation_date &lt;= :p_ur_creation_date_to OR :p_ur_creation_date_to IS NULL) å‚è€ƒhttps://community.oracle.com/thread/3924763?parent=MOSC_EXTERNAL&amp;sourceId=MOSC&amp;id=3924763 hen]]></content>
      <categories>
        <category>Oracle Cloud</category>
      </categories>
      <tags>
        <tag>Oracle Cloud</tag>
        <tag>Role-Privileges</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆè¯† OOM]]></title>
    <url>%2F2019%2F06%2F20%2FJava%2Fjvm%2Foom-1%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯ OOMOOMï¼ŒOut of Memoryï¼Œä¹Ÿå°±æ˜¯è¶…å‡ºäº†é¢„è®¾å†…å­˜ã€‚ java.lang.OutOfMemoryErrorï¼Œå®˜æ–¹è¯´æ˜Žï¼š Thrown when the Java Virtual Machine cannot allocate an object because it is out of memory, and no more memory could be made available by the garbage collector. æ„æ€å°±æ˜¯è¯´ï¼Œå½“ JVM æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥ä¸ºå¯¹è±¡åˆ†é…ç©ºé—´ï¼Œå¹¶ä¸”åžƒåœ¾å›žæ”¶å™¨ä¹Ÿå·²ç»æ²¡æœ‰ç©ºé—´å¯å›žæ”¶æ—¶ï¼Œå°±ä¼šæŠ›å‡ºè¿™ä¸ªerrorï¼ˆæ³¨ï¼šéžexceptionï¼Œå› ä¸ºè¿™ä¸ªé—®é¢˜å·²ç»ä¸¥é‡åˆ°ä¸è¶³ä»¥è¢«åº”ç”¨å¤„ç†ï¼‰ã€‚ ä¸ºä»€ä¹ˆä¼š OOMä¸»è¦åŽŸå› æœ‰ä¸¤ç‚¹ åˆ†é…å†…å­˜ä¸è¶³ï¼Œå¯ç”¨é€šè¿‡è°ƒæ•´å¯åŠ¨ VM å‚æ•°æŽ§åˆ¶ã€‚ ç¨‹åºé€»è¾‘é—®é¢˜ï¼Œå ç”¨è¿‡å¤šå†…å­˜å¹¶ä¸”ä½¿ç”¨å®Œæ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„éœ²æˆ–è€…å†…å­˜æº¢å‡ºã€‚ å…¶ä¸­ï¼š å†…å­˜æ³„æ¼ï¼šç”³è¯·ä½¿ç”¨å®Œçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾ï¼Œå¯¼è‡´è™šæ‹Ÿæœºä¸èƒ½å†æ¬¡ä½¿ç”¨è¯¥å†…å­˜ï¼Œæ­¤æ—¶è¿™æ®µå†…å­˜å°±æ³„éœ²äº†ï¼Œå› ä¸ºç”³è¯·è€…ä¸ç”¨äº†ï¼Œè€Œåˆä¸èƒ½è¢«è™šæ‹Ÿæœºåˆ†é…ç»™åˆ«äººç”¨ã€‚ï¼ˆå¾€å¾€æ˜¯ç¼–ç ä¸å½“å¯¼è‡´ï¼‰ å†…å­˜æº¢å‡ºï¼šç”³è¯·çš„å†…å­˜è¶…å‡ºäº†JVMèƒ½æä¾›çš„å†…å­˜å¤§å°ï¼Œæ­¤æ—¶ç§°ä¹‹ä¸ºæº¢å‡ºã€‚ JVM å†…å­˜æ¨¡åž‹ä¸Šé¢é¢‘ç¹æåˆ°çš„å†…å­˜æŒ‡çš„å°±æ˜¯ JVM å†…å­˜æ¨¡åž‹ã€‚ JVM åœ¨è¿è¡Œä¼šç®¡ç†ä»¥ä¸‹çš„å†…å­˜åŒºåŸŸï¼š ç¨‹åºè®¡æ•°å™¨ï¼šå½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œçº¿ç¨‹ç§æœ‰ï¼Œè®°å½•æ¯ä¸ªçº¿ç¨‹å½“å‰æ‰§è¡Œå­—èŠ‚ç çš„ä½ç½®ï¼Œå› ä¸ºä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ¥å¹¶å‘æ‰§è¡Œå„ç§ä¸åŒçš„ä»£ç ï¼Œæ‰€æœ‰æ¯ä¸ªçº¿ç¨‹ä¼šæœ‰è‡ªå·±çš„ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œä¸“é—¨è®°å½•è¿™ä¸ªçº¿ç¨‹ç›®å‰æ‰§è¡Œåˆ°å“ªä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ç§æœ‰ï¼› java è™šæ‹Ÿæœºæ ˆï¼šä¿å­˜æ–¹æ³•å†…å±€éƒ¨å˜é‡æ•°æ®çš„åŒºåŸŸï¼Œçº¿ç¨‹ç§æœ‰ã€‚çº¿ç¨‹æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šä¸ºè¿™ä¸ªæ–¹æ³•è°ƒç”¨åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªæ ˆå¸§ã€‚æ ˆå¸§é‡Œæœ‰è¿™ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æŽ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¸œè¥¿ï¼Œè°ƒç”¨æ‰§è¡Œä»»ä½•æ–¹æ³•çš„æ—¶å€™ï¼Œéƒ½ä¼šç»™æ–¹æ³•åˆ›å»ºæ ˆå¸§ï¼Œç„¶åŽå…¥æ ˆï¼Œè°ƒç”¨å®Œå†å‡ºæ ˆï¼› æœ¬åœ°æ–¹æ³•æ ˆï¼šç±»ä¼¼â€œjava è™šæ‹Ÿæœºæ ˆâ€ï¼Œä½†æ˜¯ä¸º native æ–¹æ³•çš„è¿è¡Œæä¾›å†…å­˜çŽ¯å¢ƒï¼Œè°ƒç”¨æœ¬åœ°æ“ä½œç³»ç»Ÿé‡Œé¢çš„ä¸€äº›æ–¹æ³•ï¼Œå¯èƒ½æ˜¯è°ƒç”¨ c è¯­è¨€å†™çš„åº•å±‚ç±»åº“æä¾›çš„å†…å­˜çŽ¯å¢ƒï¼› java å †å†…å­˜ï¼šå¯¹è±¡å†…å­˜åˆ†é…çš„åœ°æ–¹ï¼Œå†…å­˜åžƒåœ¾å›žæ”¶çš„ä¸»è¦åŒºåŸŸï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ã€‚å¯¹è±¡æŒ‰ä¸åŒçš„ â€œç”Ÿå­˜â€ æƒ…å†µåˆ†ä¸ºæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£ç­‰ï¼› æ–¹æ³•åŒº/Metaspaceï¼šJDK 1.8 åŽå«åš Metaspaceï¼ŒJDK 8 å¼€å§‹æŠŠç±»çš„å…ƒæ•°æ®æ”¾åˆ°æœ¬åœ°å †å†…å­˜(native heap)ä¸­ï¼Œè¿™ä¸€å—åŒºåŸŸå°±å« Metaspaceï¼Œè¯¦æƒ…è§æ·±å…¥æŽ¢ç©¶ JVM | æŽ¢ç§˜ Metaspaceï¼› å †å¤–å†…å­˜ï¼šå¹¶ä¸æ˜¯ JVM è¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œå¯ç›´æŽ¥è®¿é—®çš„å†…å­˜ï¼Œæ¯”å¦‚ NIO ä¼šç”¨åˆ°è¿™éƒ¨åˆ†ï¼› OOM ç±»åž‹ java.lang.OutOfMemoryError: Java heap spaceï¼Œæ¯”è¾ƒå¸¸è§ï¼Œjava å †å†…å­˜æº¢å‡ºã€‚è¯¦æƒ…è§OutOfMemoryErrorç³»åˆ—ï¼ˆ1ï¼‰: Java heap space java.lang.OutOfMemoryError: GC overhead limit exceededï¼Œç¨‹åºåŸºæœ¬ä¸Šè€—å°½äº†æ‰€æœ‰çš„å¯ç”¨å†…å­˜, GCä¹Ÿæ¸…ç†ä¸äº†ã€‚è¯¦æƒ…è§OutOfMemoryErrorç³»åˆ—ï¼ˆ2ï¼‰: GC overhead limit exceeded java.lang.OutOfMemoryError: PermGen spaceï¼Œjava æ°¸ä¹…ä»£æº¢å‡ºï¼Œä¹Ÿå°±æ˜¯æ–¹æ³•åŒºæº¢å‡ºï¼Œjdk 7 ä¹‹å‰ã€‚è¯¦æƒ…è§OutOfMemoryErrorç³»åˆ—ï¼ˆ3ï¼‰: Permgen space java.lang.OutOfMemoryError: Metaspaceï¼Œç›¸å½“äºŽ jdk 7ä»¥å‰çš„ java.lang.OutOfMemoryError: PermGen spaceã€‚è¯¦æƒ…è§OutOfMemoryErrorç³»åˆ—ï¼ˆ4ï¼‰: Metaspace java.lang.StackOverflowErrorï¼Œä¸ä¼šæŠ› OOM ERRORï¼Œä½†ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§çš„ Java å†…å­˜æº¢å‡º æŸ¥çœ‹åº”ç”¨è¿›ç¨‹idï¼ˆpidï¼‰åŠå¯åŠ¨ VM å‚æ•°jps -v æŸ¥æ‰¾åº”ç”¨è¿›ç¨‹ id 1234jps -v29591 Jps -Dapplication.home=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64 -Xms8m9066 Bootstrap -Djava.util.logging.config.file=/xxx/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Xms512m -Xmx2048m -Djdk.tls.ephemeralDHKeySize=2048 -Xms4096m -Xmx10240m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/xxx/dump -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/xxx/tomcat -Dcatalina.home=/xxx/lib/tomcat -Djava.io.tmpdir=/xxx/tomcat/temp jinfo -flags &lt;pid&gt; æŸ¥çœ‹ VM å¯åŠ¨å‚æ•° 12345678jinfo -flags 9066Attaching to process ID 9066, please wait...Debugger attached successfully.Server compiler detected.JVM version is 25.191-b12Non-default VM flags: -XX:CICompilerCount=3 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=null -XX:InitialHeapSize=4294967296 -XX:MaxHeapSize=10737418240 -XX:MaxNewSize=3578789888 -XX:MinHeapDeltaBytes=524288 -XX:NewSize=1431306240 -XX:OldSize=2863661056 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGCCommand line: -Djava.util.logging.config.file=/xxx/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Xms512m -Xmx2048m -Djdk.tls.ephemeralDHKeySize=2048 -Xms4096m -Xmx10240m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/xxx/dump -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/xxx/tomcat -Dcatalina.home=/xxx/lib/tomcat -Djava.io.tmpdir=/xxx/tomcat/temp jmap -heap &lt;pid&gt; æŸ¥çœ‹ VM å¯åŠ¨å‚æ•°ï¼Œä»¥åŠå †å†…å­˜æƒ…å†µ 123456789101112131415161718192021222324252627282930313233343536373839jmap -heap 9066Attaching to process ID 9066, please wait...Debugger attached successfully.Server compiler detected.JVM version is 25.191-b12using thread-local object allocation.Parallel GC with 4 thread(s)Heap Configuration: MinHeapFreeRatio = 0 MaxHeapFreeRatio = 100 MaxHeapSize = 10737418240 (10240.0MB) NewSize = 1431306240 (1365.0MB) MaxNewSize = 3578789888 (3413.0MB) OldSize = 2863661056 (2731.0MB) NewRatio = 2 SurvivorRatio = 8 MetaspaceSize = 21807104 (20.796875MB) CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB G1HeapRegionSize = 0 (0.0MB)Heap Usage:Exception in thread "main" java.lang.reflect.InvocationTargetException at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at sun.tools.jmap.JMap.runTool(JMap.java:201) at sun.tools.jmap.JMap.main(JMap.java:130)Caused by: java.lang.RuntimeException: unknown CollectedHeap type : class sun.jvm.hotspot.gc_interface.CollectedHeap at sun.jvm.hotspot.tools.HeapSummary.run(HeapSummary.java:157) at sun.jvm.hotspot.tools.Tool.startInternal(Tool.java:260) at sun.jvm.hotspot.tools.Tool.start(Tool.java:223) at sun.jvm.hotspot.tools.Tool.execute(Tool.java:118) at sun.jvm.hotspot.tools.HeapSummary.main(HeapSummary.java:50) ... 6 more ä¸Šé¢æŠ¥é”™è§£å†³ Exception when taking a heapdump using JMAP è§£å†³å†è¿è¡Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748jmap -heap 9066Attaching to process ID 9066, please wait...Debugger attached successfully.Server compiler detected.JVM version is 25.191-b12using thread-local object allocation.Parallel GC with 4 thread(s)Heap Configuration: MinHeapFreeRatio = 0 MaxHeapFreeRatio = 100 MaxHeapSize = 10737418240 (10240.0MB) NewSize = 1431306240 (1365.0MB) MaxNewSize = 3578789888 (3413.0MB) OldSize = 2863661056 (2731.0MB) NewRatio = 2 SurvivorRatio = 8 MetaspaceSize = 21807104 (20.796875MB) CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB G1HeapRegionSize = 0 (0.0MB)Heap Usage:PS Young GenerationEden Space: capacity = 1209532416 (1153.5MB) used = 279076032 (266.14764404296875MB) free = 930456384 (887.3523559570312MB) 23.073051065710338% usedFrom Space: capacity = 112721920 (107.5MB) used = 9442424 (9.004997253417969MB) free = 103279496 (98.49500274658203MB) 8.376741631086482% usedTo Space: capacity = 109051904 (104.0MB) used = 0 (0.0MB) free = 109051904 (104.0MB) 0.0% usedPS Old Generation capacity = 2976907264 (2839.0MB) used = 609708576 (581.4634094238281MB) free = 2367198688 (2257.536590576172MB) 20.481275428806907% used67050 interned Strings occupying 6996392 bytes. èŽ·å–åˆ°çš„ VM å‚æ•°ï¼Œå¯å…³æ³¨å¦‚ä¸‹å‡ é¡¹å‚æ•°çš„æƒ…å†µ 12345678-XX:+HeapDumpOnOutOfMemoryError # æ˜¯å¦å¼€å¯ OOM æ—¶è¾“å‡º dump æ–‡ä»¶ï¼Œ+ è¡¨ç¤ºå¼€å¯-XX:HeapDumpPath=/data/logs # è‹¥é…ç½®è¯¥é¡¹ï¼Œdump æ–‡ä»¶è¾“å‡ºåˆ°è¯¥è·¯å¾„ä¸‹-XX:+PrintGCDetails # æ˜¯å¦æ‰“å° GC è¯¦ç»†ä¿¡æ¯-XX:+PrintGCTimeStamps # æ˜¯å¦æ‰“å° GC æ—¶é—´æˆ³(åŸºå‡†å½¢å¼)-XX:+PrintGCDateStamps # æ˜¯å¦æ‰“å° GC æ—¶é—´æˆ³(æ—¥æœŸå½¢å¼)-XX:+PrintTenuringDistribution # åœ¨æ¯æ¬¡æ–°ç”Ÿä»£ GC æ—¶ï¼Œè¾“å‡ºå¹¸å­˜åŒºä¸­å¯¹è±¡çš„å¹´é¾„åˆ†å¸ƒ-Xloggc:/data/logs # è‹¥é…ç½®è¯¥é¡¹ï¼ŒGC æ—¥å¿—è¾“å‡ºåˆ°è¯¥è·¯å¾„ä¸‹ å¦‚æžœåº”ç”¨æ²¡æœ‰å¯ç”¨ç›¸åº”çš„å‚æ•°è¾“å‡ºæ—¥å¿—ï¼Œå¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œæŸ¥çœ‹ç›¸å…³æ—¥å¿— 12345# 1.æŸ¥çœ‹åº”ç”¨ GC æ¬¡æ•°åŠå¹³å‡æ¯æ¬¡ GC æ—¶é—´jstat -gc &lt;pid&gt; 5000 # æ¯ 5 ç§’æ˜¾ç¤ºä¸€æ¬¡ pid çš„è¿›ç¨‹ç”Ÿæˆ GC æƒ…å†µ# 2.æŸ¥çœ‹ JVM å †å†…å­˜ä¸åŒä»£çš„å…·ä½“ä½¿ç”¨æƒ…å†µjmap -heap &lt;pid&gt; # å‚ç…§ä¸Šé¢ä½¿ç”¨ å‚è€ƒJava OOM åˆ†æž OutOfMemoryErrorç³»åˆ— æ·±å…¥æŽ¢ç©¶ JVM | æŽ¢ç§˜ Metaspace]]></content>
      <categories>
        <category>Java</category>
        <category>jvm</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>jvm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[è¯‘æ–‡] Spring Security â€“ security none, filters none, access permitAll]]></title>
    <url>%2F2019%2F03%2F28%2FJava%2Fspring%2Fsecurity-none-filters-none-access-permitAll%2F</url>
    <content type="text"><![CDATA[ç‰ˆæƒè¯´æ˜Žï¼Œæ–‡ç« ç¿»è¯‘è‡³ Spring Security â€“ security none, filters none, access permitAll æ¦‚è¿°Spring Security æä¾›äº†å‡ ç§å°†è¯·æ±‚æ¨¡å¼é…ç½®ä¸ºä¸å®‰å…¨æˆ–è€…å…è®¸æ‰€æœ‰è®¿é—®çš„æœºåˆ¶ã€‚æ ¹æ®è¿™äº›æœºåˆ¶çš„ä¸åŒï¼Œè¿™å¯èƒ½æ„å‘³ç€æ ¹æœ¬ä¸åœ¨è¿™ä¸ªè·¯å¾„ä¸Šè¿è¡Œå®‰å…¨è¿‡æ»¤å™¨é“¾ï¼Œæˆ–è€…è¿è¡Œäº†å®‰å…¨è¿‡æ»¤å™¨é“¾ä½†å…è®¸è®¿é—®ã€‚ access=â€permitAllâ€ç»™ &lt;intercept-url> æ ‡ç­¾è®¾ç½® access=â€permitAllâ€ å…ƒç´ ï¼Œå°†ä¼šç»™æŒ‡å®šè·¯å¾„å…è®¸æ‰€æœ‰è¯·æ±‚æŽˆæƒ: 1&lt;intercept-url pattern="/login*" access="permitAll" /&gt; æˆ–è€…é€šè¿‡ java é…ç½®: 1http.authorizeRequests().antMatchers("/login*").permitAll() è¿™æ˜¯åœ¨ä¸ç¦ç”¨å®‰å…¨è¿‡æ»¤å™¨çš„æƒ…å†µä¸‹å®žçŽ°çš„ï¼Œè¿™äº›è¿‡æ»¤å™¨ä»åœ¨è¿è¡Œï¼Œå› æ­¤ä»»ä½•ä¸Ž Spring Security ç›¸å…³çš„åŠŸèƒ½ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚ filters=â€noneâ€è¿™æ˜¯åœ¨ Spring 3.1 å‰çš„åŠŸèƒ½ï¼Œå·²åœ¨ Spring 3.1 ä¸­å¼ƒç”¨å’Œè¢«æ›¿ä»£äº†ã€‚ è¿™ä¸ª filter å±žæ€§å®Œå…¨ç¦ç”¨æŒ‡å®šçš„è¯·æ±‚è·¯å¾„ä¸Šçš„ Spring Security è¿‡æ»¤å™¨é“¾: 1&lt;intercept-url pattern="/login*" filters="none" /&gt; å½“å¤„ç†è¯·æ±‚éœ€è¦ Spring Security çš„æŸäº›åŠŸèƒ½æ—¶ï¼Œè¿™å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚ ç”±äºŽåœ¨ Spring 3.0+ ç‰ˆæœ¬è¿™æ˜¯ä¸€ä¸ªè¢«å¼ƒç”¨çš„åŠŸèƒ½ï¼Œåœ¨ Spring 3.1 ä¸­ä½¿ç”¨å®ƒå°†å¯¼è‡´å¯åŠ¨æ—¶å‡ºçŽ°è¿è¡Œæ—¶å¼‚å¸¸: 1234567SEVERE: Context initialization failedorg.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: The use of "filters='none'" is no longer supported. Please define a separate &lt;http&gt; element for the pattern you want to exclude and use the attribute "security='none'".Offending resource: class path resource [webSecurityConfig.xml] at o.s.b.f.p.FailFastProblemReporter.error(FailFastProblemReporter.java:68) security=â€noneâ€æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„é”™è¯¯æ¶ˆæ¯ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼ŒSpring 3.1 ç”¨ä¸€ä¸ªæ–°çš„è¡¨è¾¾å¼æ›¿æ¢ filters =â€œnoneâ€ - security =â€œnoneâ€ã€‚ èŒƒå›´ä¹Ÿå‘ç”Ÿäº†å˜åŒ– â€”â€” è¿™ä¸å†åœ¨ &lt;intercept-url> å…ƒç´ çº§åˆ«æŒ‡å®šã€‚ç›¸åï¼ŒSpring 3.1 å…è®¸å®šä¹‰å¤šä¸ª &lt;http> å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±çš„å®‰å…¨è¿‡æ»¤é“¾é…ç½®ã€‚å› æ­¤ï¼Œæ–°çš„å®‰å…¨å±žæ€§çŽ°åœ¨å±žäºŽ &lt;http> å…ƒç´ çº§åˆ«ã€‚ åœ¨å®žé™…ä½¿ç”¨ä¸­ï¼Œå®ƒé•¿è¿™æ ·: 1&lt;http pattern="/resources/**" security="none"/&gt; æˆ–è€…é€šè¿‡ java é…ç½®: 1web.ignoring().antMatchers("/resources/**"); è€Œä¸æ˜¯æ—§çš„: 1&lt;intercept-url pattern="/resources/**" filters="none"/&gt; ä¸Ž filters =â€œnoneâ€ ç±»ä¼¼ï¼Œè¿™ä¹Ÿå°†å®Œå…¨ç¦ç”¨è¯¥è¯·æ±‚è·¯å¾„çš„å®‰å…¨è¿‡æ»¤å™¨é“¾ - å› æ­¤ï¼Œå½“åœ¨åº”ç”¨ç¨‹åºä¸­å¤„ç†è¯·æ±‚æ—¶ï¼ŒSpring Security åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚ å¯¹äºŽä¸Šé¢çš„ç¤ºä¾‹è€Œè¨€ï¼Œè¿™ä¸æ˜¯é—®é¢˜ï¼Œå…¶ä¸»è¦æ¶‰åŠæä¾›é™æ€èµ„æº - åœ¨å®žé™…ä¸­ä¸éœ€è¦åšç‰¹æ®Šå¤„ç†ã€‚ä½†æ˜¯ï¼Œå¦‚æžœä»¥æŸç§æ–¹å¼ä»¥ç¼–ç¨‹æ–¹å¼å¤„ç†è¯·æ±‚ - é‚£ä¹ˆå®‰å…¨åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œrequires-channelï¼Œè®¿é—®å½“å‰ç”¨æˆ·æˆ–è°ƒç”¨å®‰å…¨æ–¹æ³•ï¼‰å°†ä¸å¯ç”¨ã€‚ å‡ºäºŽåŒæ ·çš„åŽŸå› ï¼Œåœ¨å·²ç»é…ç½®äº† security=â€noneâ€ çš„ &lt;http> å…ƒç´ ä¸ŠæŒ‡å®šé™„åŠ å±žæ€§æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºè¯¥è¯·æ±‚è·¯å¾„æ˜¯ä¸å®‰å…¨çš„ï¼Œè¿™äº›å±žæ€§å°†è¢«å¿½ç•¥ã€‚ æˆ–è€…ï¼Œaccess=â€™IS_AUTHENTICATED_ANONYMOUSLYâ€™ å¯ç”¨äºŽå…è®¸åŒ¿åè®¿é—®ã€‚ Caveats for security=â€noneâ€å½“ä½¿ç”¨å¤šä¸ª &lt;http> å…ƒç´ æ—¶ï¼Œæœ‰äº›é…ç½®äº† security =â€œnoneâ€ï¼Œè¯·è®°ä½ï¼Œå®šä¹‰è¿™äº›å…ƒç´ çš„é¡ºåºå¾ˆé‡è¦ã€‚æˆ‘ä»¬åº”è¯¥é¦–å…ˆä½¿ç”¨ç‰¹å®šçš„ &lt;http> è·¯å¾„ï¼Œæœ€åŽå†ä½¿ç”¨é€šç”¨æ¨¡å¼ã€‚ å¦è¯·æ³¨æ„ï¼Œå¦‚æžœ &lt;http> å…ƒç´ æœªæŒ‡å®šæ¨¡å¼ï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜ å°„åˆ°é€šç”¨åŒ¹é…æ¨¡å¼ - â€œ/** â€ - å› æ­¤ï¼Œæ­¤å…ƒç´ å¿…é¡»æ˜¯æœ€åŽä¸€ä¸ªã€‚å¦‚æžœå…ƒç´ çš„é¡ºåºä¸æ­£ç¡®ï¼Œåˆ™å®‰å…¨è¿‡æ»¤å™¨é“¾çš„åˆ›å»ºå°†å¤±è´¥ï¼š 12345Caused by: java.lang.IllegalArgumentException: A universal match pattern ('/**') is defined before other patterns in the filter chain, causing them to be ignored. Please check the ordering in your &lt;security:http&gt; namespace or FilterChainProxy bean configuration at o.s.s.c.h.DefaultFilterChainValidator.checkPathOrder(DefaultFilterChainValidator.java:49) at o.s.s.c.h.DefaultFilterChainValidator.validate(DefaultFilterChainValidator.java:39) ç»“è®ºæœ¬æ–‡è®¨è®ºäº†å…è®¸ä½¿ç”¨ Spring Security è®¿é—®è·¯å¾„çš„é€‰é¡¹ - é‡ç‚¹å…³æ³¨ filters =â€œnoneâ€ï¼Œsecurity =â€œnoneâ€ å’Œ access =â€œpermitAllâ€ ä¹‹é—´çš„å·®å¼‚ã€‚ åƒå¾€å¸¸ä¸€æ ·ï¼Œè¿™äº›ä¾‹å­å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°ã€‚ å‚è€ƒèµ„æ–™ Spring Security â€“ security none, filters none, access permitAll]]></content>
      <categories>
        <category>Java</category>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java ä»£ç†ä¸­è½¬ä¸‹è½½ url æ–‡ä»¶]]></title>
    <url>%2F2019%2F03%2F21%2FJava%2Fjava-proxy-url-file%2F</url>
    <content type="text"><![CDATA[åœºæ™¯æè¿°æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤–ç½‘è®¿é—®çš„ java web ç³»ç»Ÿ Aï¼Œè¿™ä¸ªç³»ç»Ÿä¼šåŽ»è¯·æ±‚ä¸€ä¸ªå†…ç½‘ç³»ç»Ÿ B èŽ·å–æ–‡ä»¶æŽ¥å£ï¼Œè¿™ä¸ªæŽ¥å£ä¼šè¿”å›žä¸€ä¸ªå†…ç½‘çš„ä¸‹è½½åœ°å€ç»™æˆ‘ä»¬ã€‚å‡å¦‚æˆ‘ä»¬åªæ˜¯æŠŠåœ°å€æä¾›å‡ºåŽ»ï¼Œè¿™ä¸ªæ—¶å€™å¤–ç½‘æ˜¯æ— æ³•ä¸‹è½½åˆ°æ–‡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ A ç³»ç»Ÿå¯¹ B ç³»ç»Ÿè¿”å›žçš„æ–‡ä»¶ä¸‹è½½åœ°å€è¿›è¡Œä¸­è½¬ï¼Œä»Žè€Œæš´éœ²å‡ºåŸºäºŽ A ç³»ç»Ÿçš„å¤–ç½‘ä¸‹è½½åœ°å€ã€‚ ä»£ç å¼€å‘12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/** * url æ–‡ä»¶ä»£ç†ä¸­è½¬ * @param response * @param address * @param contentType * @param fileName * @throws IOException */ public static void proxyUrlFile(HttpServletResponse response, String address, String contentType, String fileName) throws IOException &#123; InputStream inputStream = null; ServletOutputStream outputStream = null; HttpURLConnection httpURLConnection = null; try &#123; URL url = new URL(address); httpURLConnection = (HttpURLConnection) url.openConnection(); httpURLConnection.connect(); inputStream = httpURLConnection.getInputStream(); outputStream = response.getOutputStream(); if (contentType != null) &#123; response.setContentType(contentType); &#125; else &#123; // è®¾ç½®æ–‡ä»¶ContentTypeç±»åž‹ï¼Œè¿™æ ·è®¾ç½®ï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­ä¸‹è½½æ–‡ä»¶ç±»åž‹ response.setContentType("multipart/form-data"); &#125; if (fileName != null) &#123; response.setHeader("Content-disposition", "attachment; filename=\"" + new String(fileName.getBytes("utf-8"), "ISO8859-1")+"\""); &#125; // åˆ›å»ºä¸€ä¸ªBufferå­—ç¬¦ä¸² byte[] buffer = new byte[1024]; // æ¯æ¬¡è¯»å–çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æžœä¸º-1ï¼Œä»£è¡¨å…¨éƒ¨è¯»å–å®Œæ¯• int len = 0; // ä½¿ç”¨ä¸€ä¸ªè¾“å…¥æµä»Žbufferé‡ŒæŠŠæ•°æ®è¯»å–å‡ºæ¥ while((len = inputStream.read(buffer)) != -1 )&#123; // ç”¨è¾“å‡ºæµå¾€bufferé‡Œå†™å…¥æ•°æ®ï¼Œä¸­é—´å‚æ•°ä»£è¡¨ä»Žå“ªä¸ªä½ç½®å¼€å§‹è¯»ï¼Œlenä»£è¡¨è¯»å–çš„é•¿åº¦ outputStream.write(buffer, 0, len); &#125; &#125; catch (Exception e) &#123; log.error("Proxy URL File error, e = &#123;&#125;", e); throw e; &#125; finally &#123; if (inputStream != null) &#123; inputStream.close(); &#125; if (outputStream != null) &#123; outputStream.flush(); outputStream.close(); &#125; if (httpURLConnection != null) &#123; httpURLConnection.disconnect(); &#125; &#125; &#125; æµ‹è¯•123456789101112131415@Controllerpublic class TestController &#123; /** * url æ–‡ä»¶ä»£ç†ä¸­è½¬ * @param response * @param fileName * @param url * @throws IOException */ @RequestMapping("/fnd/proxy/url/file") public void proxyFile(HttpServletResponse response, @RequestParam("fileName") String fileName, @RequestParam("url") String url) throws IOException &#123; FileOperateUtil.proxyUrlFile(response, url, null, fileName); &#125;&#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ADFS å®‰è£…åŠé…ç½®]]></title>
    <url>%2F2019%2F03%2F11%2Fsso%2Fadfs%2Fadfs-install%2F</url>
    <content type="text"><![CDATA[å®‰è£…å‰å‡†å¤‡åœ¨å®‰è£… ADFS ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡å· DCï¼Œå‚è€ƒ ADDS æ´»åŠ¨ç›®å½•å®‰è£…è¯¦è§£ å®‰è£…é…ç½®è¯ä¹¦æœåŠ¡åœ¨ DC ä¸Šå®‰è£… CA æ‰“å¼€æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œç‚¹å‡» â€œæ·»åŠ è§’è‰²å’ŒåŠŸèƒ½â€ ä¿æŒé»˜è®¤ï¼Œå¹¶è¿žç»­ç‚¹å‡»ä¸‰æ¬¡â€œä¸‹ä¸€æ­¥â€ å‹¾é€‰ â€œActive Directory è¯ä¹¦æœåŠ¡â€ï¼Œç„¶åŽé€‰æ‹©æ·»åŠ æ‰€éœ€çš„åŠŸèƒ½ï¼Œæœ€åŽç‚¹â€œä¸‹ä¸€æ­¥â€ç»§ç»­ åŠŸèƒ½é€‰æ‹©é¡µé¢ä¿æŒé»˜è®¤ï¼Œè¿žç»­ç‚¹å‡»2æ¬¡â€œä¸‹ä¸€æ­¥â€ å‹¾é€‰ CA ç›¸å…³æœåŠ¡, ä¸€ç›´ç‚¹ä¸‹ä¸€æ­¥ï¼Œæœ€åŽç‚¹å‡»å®‰è£… å®‰è£…å®Œæˆ é…ç½®è¯ä¹¦æœåŠ¡ CA å®‰è£…å®ŒæˆåŽï¼Œå¦‚å›¾ç‚¹å‡»æç¤ºå›¾æ ‡åŽï¼Œé€‰æ‹©â€œé…ç½®ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ Active Directory è¯ä¹¦æœåŠ¡â€ æ ¹æ®å‘å¯¼è¿›è¡Œé…ç½® å‹¾é€‰æ‰€éœ€è¦é…ç½®çš„æœåŠ¡ é€‰æ‹©ä¼ä¸šæ ¹ åˆ›å»ºæ–°çš„ç§é’¥ æŒ‡å®š CA åç§° æŒ‡å®šæœ‰æ•ˆæœŸ æŒ‡å®šæ•°æ®åº“ä½ç½® ç¡®è®¤é…ç½®ä¿¡æ¯ é…ç½®å®Œæˆ éªŒè¯ CA ä»¥ä¸ŠçŽ¯å¢ƒå‡†å¤‡å¥½åŽå°±å¯ä»¥é…ç½® ADFS æœåŠ¡å™¨äº†ã€‚åœ¨é…ç½®å‰æˆ‘ä»¬éœ€è¦ç»™è®¡ç®—æœºæˆ–è€…æŒ‡å®šçš„ç”¨æˆ·æˆ–è€…è®¡ç®—æœºæŽˆæƒè¯ä¹¦é¢å‘ã€‚ å®‰è£…ADFSæœåŠ¡åœ¨å®‰è£… ADFS ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå’Œé…ç½®è¯ä¹¦ åˆ›å»ºè¯ä¹¦è´¦æˆ·å‡†å¤‡å¥½åŽï¼Œç„¶åŽç”³è¯·è¯ä¹¦ï¼Œå…¶å®žæœ‰å¾ˆå¸¸è§çš„ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§å°±æ˜¯é€šè¿‡iisè¿›è¡Œè¯ä¹¦ç”³è¯·ï¼Œç¬¬äºŒç§é€šè¿‡ mmc æŽ§åˆ¶å°è¿›è¡Œç”³è¯·ï¼Œè¿™é‡Œä½¿ç”¨IISçš„ç”³è¯·æ–¹æ³•ã€‚ æ‰“å¼€IISç®¡ç†å™¨ï¼Œé€‰æ‹©ã€æœåŠ¡å™¨è¯ä¹¦ã€‘åˆ›å»ºè¯ä¹¦ç”³è¯· ä¿å­˜åˆ°æ¡Œé¢ä¸Šï¼šcert.txt é…ç½®è¯ä¹¦ æœåŠ¡å™¨æµè§ˆå™¨ï¼Œè¾“å…¥ http://127.0.0.1/certsrv/ å¦‚ä¸‹ï¼š é€‰æ‹©ç”³è¯·è¯ä¹¦â€”â€”&gt;é«˜çº§è¯ä¹¦ç”³è¯· é€‰æ‹©ï¼š ä½¿ç”¨ base64 ç¼–ç çš„ CMC æˆ– PKCS #10 æ–‡ä»¶æäº¤ ä¸€ä¸ªè¯ä¹¦ç”³è¯·ï¼Œæˆ–ä½¿ç”¨ base64 ç¼–ç çš„ PKCS #7 æ–‡ä»¶ç»­è®¢è¯ä¹¦ç”³è¯· æ‰“å¼€cert.txt ï¼Œç²˜è´´è¿›åŽ»ï¼Œè¯ä¹¦æ¨¡æ¿é€‰æ‹© webæœåŠ¡å™¨ï¼Œæäº¤ ä¸‹è½½è¯ä¹¦ï¼Œä¿å­˜åˆ°æœ¬åœ°ï¼š å›žåˆ°iisç®¡ç†å™¨ï¼Œé€‰æ‹©å®Œæˆè¯ä¹¦ç”³è¯· å°† default web site çš„ https ç»‘å®šè¯ä¹¦æ”¹ä¸ºåˆšæ‰å®Œæˆçš„è¯ä¹¦ é€‰æ‹© default web site , å³é”® ç¼–è¾‘ç»‘å®šï¼Œé€‰æ‹© httpsï¼ˆæ²¡æœ‰åˆ™æ·»åŠ ï¼‰ ï¼Œ ç‚¹å‡»ç¼–è¾‘ï¼Œé€‰æ‹© ssl è¯ä¹¦:ï¼ˆ è¿™ä¸ªè¯ä¹¦åœ¨å®‰è£…adfsæ—¶ä½¿ç”¨è¯¥è¯ä¹¦ï¼‰ å¼€å§‹å®‰è£… æ‰“å¼€æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œç‚¹å‡» â€œæ·»åŠ è§’è‰²å’ŒåŠŸèƒ½â€ ä¿æŒé»˜è®¤ï¼Œå¹¶è¿žç»­ç‚¹å‡»ä¸‰æ¬¡â€œä¸‹ä¸€æ­¥â€ å‹¾é€‰ â€œActive Directory Federation Servicesâ€ å®‰è£…æœåŠ¡è§’è‰² åŠŸèƒ½é€‰æ‹©é¡µé¢ä¿æŒé»˜è®¤ï¼Œè¿žç»­ç‚¹å‡»2æ¬¡â€œä¸‹ä¸€æ­¥â€ å®‰è£… å®‰è£…å®Œæˆ ADFS å®‰è£…å®ŒæˆåŽï¼Œå¦‚å›¾ç‚¹å‡»æç¤ºå›¾æ ‡åŽï¼Œé€‰æ‹©â€œåœ¨æ­¤æœåŠ¡å™¨ä¸Šé…ç½®è”åˆèº«ä»½éªŒè¯æœåŠ¡â€ åŠŸèƒ½é€‰æ‹©é¡µé¢ä¿æŒé»˜è®¤ï¼Œè¿žç»­ç‚¹å‡»2æ¬¡â€œä¸‹ä¸€æ­¥â€ é€‰æ‹©è¯ä¹¦(ä¸æ˜¯å‰é¢åˆ›å»ºçš„è¯ä¹¦)ï¼Œå¡«å†™æ˜¾ç¤ºçš„åç§° é€‰æ‹© adfs æœåŠ¡å¸å· æŒ‡å®šé…ç½®æ•°æ®åº“ ä¸‹ä¸€æ­¥ é…ç½® é…ç½®å®Œæˆ è‡³æ­¤ ADFS å®‰è£…é…ç½®å®Œæˆ å‚è€ƒWindows Server 2016 å®‰è£…åŠé…ç½® ADFS 4.0 Server2012 ä¸‹ éƒ¨ç½²adfs IFD]]></content>
      <categories>
        <category>SSO</category>
        <category>ADFS</category>
      </categories>
      <tags>
        <tag>SSO</tag>
        <tag>ADFS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ADDS æ´»åŠ¨ç›®å½•å®‰è£…è¯¦è§£]]></title>
    <url>%2F2019%2F03%2F09%2Fsso%2Fadfs%2Fadds-install%2F</url>
    <content type="text"><![CDATA[å®‰è£…å‰å‡†å¤‡ç¡®ä¿åŸŸæŽ§åˆ¶å™¨ (DC) çš„è®¡ç®—æœºåç¬¦åˆä¼ä¸šå‘½åè§„èŒƒï¼Œå› ä¸º AD å®‰è£…å®ŒæˆåŽå†æ›´æ”¹ DC è®¡ç®—æœºç›¸å¯¹å¤æ‚è€Œä¸”å­˜åœ¨é£Žé™©ã€‚DC éœ€è¦ä½¿ç”¨å›ºå®šçš„é™æ€IPåœ°å€ï¼Œå¹¶ä¸”æŠŠDNSè®¾ç½®æŒ‡å‘æœ¬æœºIPã€‚ è¿™å°ç”µè„‘ (å³é”®) â€“&gt; å±žæ€§ï¼Œæ›´æ”¹è®¾ç½®ï¼š ç½‘ç»œ (å³é”®) â€“&gt; å±žæ€§ â€“&gt; ä»¥å¤ªç½‘ â€“&gt; å±žæ€§ â€“&gt; Internet åè®®ç‰ˆæœ¬ 4ï¼ˆTCP/IPV4ï¼‰ â€“&gt; å±žæ€§ å¼€å§‹å®‰è£… æ‰“å¼€æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œç‚¹å‡» â€œæ·»åŠ è§’è‰²å’ŒåŠŸèƒ½â€ ä¿æŒé»˜è®¤ï¼Œå¹¶è¿žç»­ç‚¹å‡»ä¸‰æ¬¡â€œä¸‹ä¸€æ­¥â€ã€‚ å‹¾é€‰ â€œActiveDirectoryåŸŸæœåŠ¡â€ï¼Œç„¶åŽé€‰æ‹©æ·»åŠ æ‰€éœ€çš„åŠŸèƒ½ï¼Œæœ€åŽç‚¹â€œä¸‹ä¸€æ­¥â€ç»§ç»­ã€‚ åŠŸèƒ½é€‰æ‹©é¡µé¢ä¿æŒé»˜è®¤ï¼Œè¿žç»­ç‚¹å‡»2æ¬¡â€œä¸‹ä¸€æ­¥â€ã€‚ å‹¾é€‰è‡ªåŠ¨é‡å¯æœåŠ¡å™¨ï¼Œç‚¹å‡»â€œå®‰è£…â€ã€‚ å®ŒæˆADDSå®‰è£…åŽï¼Œå¦‚å›¾ç‚¹å‡»æç¤ºå›¾æ ‡åŽï¼Œé€‰æ‹©â€œå°†æ­¤æœåŠ¡å™¨æå‡ä¸ºåŸŸæŽ§åˆ¶å™¨â€ã€‚ ç”±äºŽè¿™æ˜¯ç¬¬ä¸€å°åŸŸæŽ§åˆ¶å™¨(DC)ï¼Œä¹Ÿå«æž—æ ¹åŸŸã€‚é€‰æ‹©â€œæ·»åŠ æ–°æž—â€ï¼Œç„¶åŽè¾“å…¥æ ¹åŸŸåã€‚ é€‰æ‹©æž—å’ŒåŸŸåŠŸèƒ½çº§åˆ«ï¼Œå‹¾é€‰DNS(ADéœ€è¦é«˜åº¦é›†æˆDNS)ï¼Œå¹¶è¾“å…¥ç›®å½•è¿˜åŽŸæ¨¡å¼å¯†ç ã€‚ ç”±äºŽçŽ°åœ¨è¿˜æ²¡æœ‰DNSæœåŠ¡å™¨ï¼Œæ‰€ä»¥ä¼šæç¤ºæ— æ³•åˆ›å»ºå§”æ´¾ã€‚ç›´æŽ¥â€œä¸‹ä¸€æ­¥â€ã€‚ NetBIOSåä»¥åŠADDSæ•°æ®åº“ã€æ—¥å¿—ã€Sysvolä¿å­˜ä½ç½®ï¼Œå¦‚æžœä¼ä¸šæ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œä¸€èˆ¬ä¿æŒé»˜è®¤å³å¯ã€‚ æ£€æŸ¥é…ç½®æ— è¯¯åŽç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œç„¶åŽç‚¹å‡»â€œå®‰è£…â€ï¼Œç­‰å¾…å®‰è£…å®ŒæˆåŽé‡å¯å³å¯ã€‚ è‡³æ­¤å®Œæˆ ActiveDirectory çš„å…¨éƒ¨å®‰è£…ã€‚å·²ç»å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ã€‚ å‚è€ƒActive Directoryç®¡ç†ä¹‹ä¸€:æ´»åŠ¨ç›®å½•å®‰è£…è¯¦è§£]]></content>
      <categories>
        <category>SSO</category>
        <category>ADFS</category>
      </categories>
      <tags>
        <tag>SSO</tag>
        <tag>ADFS</tag>
        <tag>ADDS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[è½¬è½½] èŽ·å–è¢«ä»£ç†ç±»çš„çœŸå®žç±»]]></title>
    <url>%2F2019%2F03%2F07%2FJava%2Fspring%2Ftarget-class%2F</url>
    <content type="text"><![CDATA[ç‰ˆæƒè¯´æ˜Žï¼Œæ–‡ç« è½¬è½½è‡ª Spring ç¬”è®°-èŽ·å–è¢«ä»£ç†çš„çœŸå®žç±» å¯¹ä¸€ä¸ª Autowired è¿›æ¥çš„ç±»è°ƒç”¨ getClassï¼Œå‘çŽ°å¾—åˆ°çš„ç±»æ˜¯: com.xxx.search.provider.service.SearchServiceImpl$$EnhancerBySpringCGLIB$$129db519ï¼Œä¸€çœ‹å°±ä¸æ˜¯æ­£ç»ç±»ã€‚ä»Žåå­—ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ˜¯è¢«ä»£ç†åŽçš„ç±»ï¼Œå¯èƒ½å› ä¸ºè¿™ä¸ªç±»è¢«AOPäº†å§ã€‚ä½†æ˜¯æˆ‘åœ¨åå°„æ“ä½œæ˜¯éœ€è¦åŽŸå§‹çš„ç±»çš„ä¿¡æ¯ï¼Œè¦å¦‚ä½•å¾—åˆ°å‘¢ï¼Ÿ org.springframework.aop ä¸‹æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æŽ¥å£: TargetClassAware, è¿™ä¸ªæŽ¥å£è¡¨ç¤ºç›®å‰è¿™ä¸ªç±»æ˜¯è¢«ä»£ç†çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­ä¸€ä¸ªå®žä¾‹æ˜¯å¦æ˜¯ TargetClassAware çš„å®žä¾‹æ¥åˆ¤æ–­ä»–æ˜¯å¦æ˜¯ä¸€ä¸ªä»£ç†ç±»ã€‚è€Œä¸” TargetClassAware æŽ¥å£æä¾›äº† getTargetClass æ–¹æ³•æ¥èŽ·å–çœŸå®žç±»ã€‚å¯ä»¥è¿™ä¹ˆç”¨ï¼š 123if (aInstance instanceof TargetClassAware) &#123; aInstance.getTargetClass();&#125; ä¸è¿‡æ›´æŽ¨èçš„åšæ³•æ˜¯ä½¿ç”¨ org.springframework.aop.support.AopUtils æä¾›çš„ getTargetClass æ–¹æ³•æ¥èŽ·å–çœŸå®žç±»ã€‚å¯ä»¥çœ‹çœ‹å…¶æºç ï¼š 12345678910111213public static Class&lt;?&gt; getTargetClass(Object candidate) &#123; Assert.notNull(candidate, "Candidate object must not be null"); Class result = null; if(candidate instanceof TargetClassAware) &#123; result = ((TargetClassAware)candidate).getTargetClass(); &#125; if(result == null) &#123; result = isCglibProxy(candidate)?candidate.getClass().getSuperclass():candidate.getClass(); &#125; return result;&#125; ä»£ç é¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯ TargetClassAware çš„å®žçŽ°ï¼Œå¦‚æžœæ˜¯ï¼Œè°ƒç”¨ getTargetClassï¼Œæ–¹æ³•è¿˜åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯ CglibProxyï¼Œå¦‚æžœæ˜¯åŸºäºŽ cglib çš„ä»£ç†ç±»ï¼Œå› ä¸ºæ˜¯åŸºäºŽç»§æ‰¿æ¥å®žçŽ°ä»£ç†ï¼Œæ‰€ä»¥èŽ·å–çˆ¶ç±»å°±æ˜¯çœŸå®žç±»äº†ã€‚ å‚è€ƒèµ„æ–™ java - Obtain real Class object for Spring bean - Stack Overflow AopUtils)]]></content>
      <categories>
        <category>Java</category>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[oracle cloud å¦‚ä½•èŽ·å–å›¾ç‰‡ url]]></title>
    <url>%2F2019%2F02%2F20%2Foracle-cloud%2Fhow-to-get-image-url%2F</url>
    <content type="text"><![CDATA[ä»¥èŽ·å–ç‰©æ–™å›¾ç‰‡ url ä½œä¸ºä¾‹å­ 123456789101112(SELECT (decode(datatype_code, 'FILE', (:p_host || '/cs/idcplg?IdcService=GET_FILE&amp;dID=') || dm_version_number, 'WEB_PAGE', url)) AS image FROM fnd_attached_documents d, fnd_documents_vl dv WHERE d.document_id = d.document_id AND d.entity_name = 'ITEM_ENTITY' AND d.pk1_value = to_char(esi.organization_id) AND d.pk2_value = to_char(esi.inventory_item_id) AND rownum = 1) AS item_photo å…¶ä¸­ p_host ä¸º cloud çš„ä¸»åŸŸå å…¶ä»–ç±»åž‹çš„å›¾ç‰‡ url å¯ä»¥é€šè¿‡å˜æ¢ d.entity_name = &#39;ITEM_ENTITY&#39; è¿›è¡ŒæŸ¥æ‰¾]]></content>
      <categories>
        <category>Oracle Cloud</category>
      </categories>
      <tags>
        <tag>Oracle Cloud</tag>
        <tag>attachment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•èŽ·å– oracle cloud çš„ PO çš„ shipping method]]></title>
    <url>%2F2019%2F02%2F20%2Foracle-cloud%2Fpo%2Fhow-to-get-shipping-method%2F</url>
    <content type="text"><![CDATA[ç‰ˆæœ¬ä¿¡æ¯ Oracle Cloud Application 19B (11.13.19.04.0) example èŽ·å– po å¤´ä¸Šçš„ shipping method 12345678910111213SELECT po_bip_helper.get_shipping_method(carrierpartyname.party_name, modeoftransportlookuppeo.meaning, servicelevellookuppeo.meaning) AS shippingmethod FROM wsh_carriers carrier, hz_parties carrierpartyname, fnd_lookups modeoftransportlookuppeo, fnd_lookups servicelevellookuppeo, po_headers_all header WHERE (header.mode_of_transport = modeoftransportlookuppeo.lookup_code(+) AND modeoftransportlookuppeo.lookup_type(+) = 'WSH_MODE_OF_TRANSPORT') AND (header.service_level = servicelevellookuppeo.lookup_code(+) AND servicelevellookuppeo.lookup_type(+) = 'WSH_SERVICE_LEVELS') AND header.carrier_id = carrier.carrier_id(+) AND carrier.carrier_id = carrierpartyname.party_id(+) AND header.segment1 = '20000028' èŽ·å– po è¡Œä¸Šçš„ shipping method 1234567891011121314SELECT po_bip_helper.get_shipping_method(carrierpartyname.party_name, modeoftransportlookuppeo.meaning, servicelevellookuppeo.meaning) AS shippingmethod FROM wsh_carriers carrier, hz_parties carrierpartyname, fnd_lookups modeoftransportlookuppeo, fnd_lookups servicelevellookuppeo, po_line_locations_all plla WHERE (plla.mode_of_transport = modeoftransportlookuppeo.lookup_code(+) AND modeoftransportlookuppeo.lookup_type(+) = 'WSH_MODE_OF_TRANSPORT') AND (plla.service_level = servicelevellookuppeo.lookup_code(+) AND servicelevellookuppeo.lookup_type(+) = 'WSH_SERVICE_LEVELS') AND plla.carrier_id = carrier.carrier_id(+) AND carrier.carrier_id = carrierpartyname.party_id(+) AND plla.po_header_id = pla.po_header_id AND plla.po_line_id = pla.po_line_id]]></content>
      <categories>
        <category>Oracle Cloud</category>
        <category>PO</category>
      </categories>
      <tags>
        <tag>Oracle Cloud</tag>
        <tag>PO</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•èŽ·å– oracle cloud çš„ Match Approval Level]]></title>
    <url>%2F2019%2F02%2F20%2Foracle-cloud%2Fhow-to-get-match-approval-level%2F</url>
    <content type="text"><![CDATA[ç‰ˆæœ¬ä¿¡æ¯Oracle Cloud Application Revision 13.18.10 (11.13.18.10.0) Title Description Oracle Application Development Framework JDEVADF_11.1.1.9.2ADF-REL131810-PROD-BP_GENERIC_181116.1437.7206 Oracle Middleware Extensions for Applications ATGPF_PT.REL13.18.10_GENERIC_181113.1603.REL13BP16.7 Database Compatibility TRUE (REL13BP16.7) æç¤º When Receipt Required Flag is N, then Match Approval level is 2 way. When Receipt Required Flag is Y and Inspection Required Flag is N, then Match Approval Level is 3 way. When Receipt Required Flag is Y and Inspection Required Flag is Y, then Match Approval Level is 4 way. 2-way ä¸éœ€è¦æ£€æµ‹æ”¶è´§ receipt_required_flag ä¸º N 3-way éœ€è¦åœ¨ match invoice çš„æ—¶å€™éªŒæ”¶è´§ æ‰€ä»¥ receipt_required_flag ä¸ºY , inspection_required_flag ä¸º N 4-way è¿˜è¦æ£€æµ‹éªŒè´§ æ‰€ä»¥ ä¸¤ä¸ªéƒ½ä¸º Y SQL123456789decode(poz_supplier_sites_v.receipt_required_flag, 'Y', decode(poz_supplier_sites_v.inspection_required_flag, 'Y', '4-Way', 'N', '3-Way'), 'N', '2-Way') AS matching_level å‚è€ƒhttp://j178.mtgbb.com/?p=713]]></content>
      <categories>
        <category>Oracle Cloud</category>
      </categories>
      <tags>
        <tag>Oracle Cloud</tag>
        <tag>Match Approval Level</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitlab æ›´æ–° fork çš„ä»£ç ]]></title>
    <url>%2F2019%2F02%2F18%2Fgit%2Fgitlab-update-fork%2F</url>
    <content type="text"><![CDATA[æ“ä½œæ­¥éª¤ å…ˆç¡®å®šæ˜¯å¦å»ºç«‹äº†ä¸»ä»“åº“çš„è¿œç¨‹æ•°æ®æº: 1git remote -v æˆ‘ä»¬å‘çŽ°åªæœ‰æˆ‘ä»¬è‡ªå·±çš„ä¸¤ä¸ªæº(fetch å’Œ push)ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±éœ€è¦æ·»åŠ ä¸»ä»“åº“çš„æºã€‚ æ·»åŠ ä¸»ä»“åº“çš„æº 1git remote add upstream URL upstream : éšä¾¿èµ·çš„åå­— URLï¼š forkçš„ä»“åº“åœ°å€ å¦‚æžœæƒ³åˆ é™¤remoteçš„upstreamæ ‡ç­¾ï¼Œåˆ™å¯ä»¥è¿è¡Œï¼š git remote rm upstream æ›´æ–°ä»£ç  123git fetch upstreamgit checkout mastergit merge upstream/master å‚è€ƒhttps://blog.csdn.net/lhh1113/article/details/71038154]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSTACK åˆ†æžçº¿ç¨‹]]></title>
    <url>%2F2019%2F02%2F11%2FJava%2Fjstack-cpu%2F</url>
    <content type="text"><![CDATA[æŸ¥æ‰¾ tomcat çº¿ç¨‹å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ‰¾ï¼š jps ä¸€èˆ¬Bootstrapéƒ½æ˜¯tomcatçš„ ps -ef |grep tomcat jstack dump å‡ºçº¿ç¨‹1jstack 23524 &gt; jstack.txt æŸ¥çœ‹ tomcat å†…éƒ¨çº¿ç¨‹1top -H -p 23524 ï¼ˆshift+p æŒ‰ cpu æŽ’åºï¼Œshift+m æŒ‰å†…å­˜æŽ’åºï¼‰ å°†PIDæ¢ç®—æˆ16è¿›åˆ¶ï¼Œç„¶åŽåœ¨jstack.txtæŸ¥æ‰¾nid=0xæ¢ç®—åŽçš„æ•°1cat jstack.txt | grep 'nid=0x5be9' -B 5 -A 40 å‘çŽ°é¢‘ç¹çš„GCï¼ŒæŽ¨æµ‹æ˜¯ä¸æ˜¯æ•°æ®åº“åœ¨é¢‘ç¹çš„å¼€å…³å¯¼è‡´ï¼Œå› æ­¤æ£€æŸ¥ tomcat jndiæ˜¯å¦æ²¡é…ç½®æ•°æ®åº“è¿žæŽ¥æ± å‚æ•° åŠ ä¸Šè¿žæŽ¥æ± å‚æ•° å‚è€ƒjstackåˆ†æžcpuè´Ÿè½½è¿‡é«˜åŽŸå› ï¼š https://blog.csdn.net/u010248330/article/details/80080605 jstack: Javaå ç”¨é«˜CPUåˆ†æžä¹‹- GC Task Thread: https://blog.csdn.net/chenxiusheng/article/details/74007040]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Jstack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatis ä¼ å…¥å‚æ•°ä¸º Listã€Arrayã€Map]]></title>
    <url>%2F2019%2F02%2F08%2FJava%2FMyBatis%2Fmybatis-collection-params%2F</url>
    <content type="text"><![CDATA[foreach æ ‡ç­¾ç®€å•ä»‹ç»ä¸»è¦ç”¨äºŽåœ¨SQLè¯­å¥ä¸­æž„å»ºå¾ªçŽ¯ä½“ æ ‡ç­¾çš„ä¸»è¦å±žæ€§æœ‰ itemï¼Œindexï¼Œcollectionï¼Œopenï¼Œseparatorï¼Œcloseã€‚ å±žæ€§ æè¿° item é›†åˆä¸­æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œè¿­ä»£æ—¶çš„åˆ«åã€‚è¯¥å‚æ•°ä¸ºå¿…é€‰ã€‚ index æŒ‡å®šä¸€ä¸ªåå­—ï¼Œç”¨äºŽè¡¨ç¤ºåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ²¡é”™è¿­ä»£åˆ°çš„ä½ç½® open è¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆå¼€å§‹ close è¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆç»“æŸ separator è¡¨ç¤ºåœ¨æ¯æ¬¡è¿›è¡Œè¿­ä»£ä¹‹é—´ä»¥ä»€ä¹ˆç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦ collection å±žæ€§æ˜¯åœ¨ä½¿ç”¨foreachçš„æ—¶å€™æœ€å…³é”®çš„ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé”™çš„ï¼Œè¯¥å±žæ€§æ˜¯å¿…é¡»æŒ‡å®šçš„ï¼Œä½†æ˜¯åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œè¯¥å±žæ€§çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸»è¦æœ‰ä¸€ä¸‹3ç§æƒ…å†µï¼š (1) å¦‚æžœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»åž‹æ˜¯ä¸€ä¸ªListçš„æ—¶å€™ï¼Œcollectionå±žæ€§å€¼ä¸ºlist .(2) å¦‚æžœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»åž‹æ˜¯ä¸€ä¸ªarrayæ•°ç»„çš„æ—¶å€™ï¼Œcollectionçš„å±žæ€§å€¼ä¸ºarray .(3) å¦‚æžœä¼ å…¥çš„å‚æ•°æ˜¯å¤šä¸ªçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠå®ƒä»¬å°è£…æˆä¸€ä¸ªMapäº†ï¼Œå½“ç„¶å•å‚æ•°ä¹Ÿå¯ä»¥å°è£…æˆmapï¼Œå®žé™…ä¸Šå¦‚æžœä½ åœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™ï¼Œåœ¨MyBatisé‡Œé¢ä¹Ÿæ˜¯ä¼šæŠŠå®ƒå°è£…æˆä¸€ä¸ªMapçš„ï¼Œmapçš„keyå°±æ˜¯å‚æ•°åï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™collectionå±žæ€§å€¼å°±æ˜¯ä¼ å…¥çš„Listæˆ–arrayå¯¹è±¡åœ¨è‡ªå·±å°è£…çš„mapé‡Œé¢çš„key.(4) å¦‚æžœå‚æ•°ä½¿ç”¨äº†@Paramæ³¨è§£ï¼Œé‚£å¿…é¡»æ˜¯å‚æ•°å ç¤ºä¾‹å»ºè¡¨è¯­å¥1234567891011121314151617181920212223242526272829DROP TABLE IF EXISTS `XXGL_CODE_COMBINATIONS`;CREATE TABLE `XXGL_CODE_COMBINATIONS`( `COMBINATION_ID` bigint AUTO_INCREMENT NOT NULL COMMENT 'è¡¨IDï¼Œä¸»é”®ï¼Œä¾›å…¶ä»–è¡¨åšå¤–é”®' , `CODE_COMBINATION_ID` bigint NOT NULL , `ENABLED_FLAG` varchar(1) NOT NULL COMMENT 'Y/N' , `ACCOUNT_TYPE` varchar(10) NOT NULL COMMENT 'è´¦æˆ·ç±»åž‹' , `SEGMENT1` varchar(25) NULL COMMENT 'æ®µå€¼1', `SEGMENT2` varchar(25) NULL COMMENT 'æ®µå€¼2', `SEGMENT3` varchar(25) NULL COMMENT 'æ®µå€¼3', `SEGMENT4` varchar(25) NULL COMMENT 'æ®µå€¼4', `SEGMENT5` varchar(25) NULL COMMENT 'æ®µå€¼5', `SEGMENT6` varchar(25) NULL COMMENT 'æ®µå€¼6', `SEGMENT7` varchar(25) NULL COMMENT 'æ®µå€¼7', `SEGMENT8` varchar(25) NULL COMMENT 'æ®µå€¼8', `SEGMENT9` varchar(25) NULL COMMENT 'æ®µå€¼9', `SEGMENT10` varchar(25) NULL COMMENT 'æ®µå€¼10', `SEGMENT11` varchar(25) NULL COMMENT 'æ®µå€¼11', `SEGMENT12` varchar(25) NULL COMMENT 'æ®µå€¼12', `SEGMENT13` varchar(25) NULL COMMENT 'æ®µå€¼13', `SEGMENT14` varchar(25) NULL COMMENT 'æ®µå€¼14', `SEGMENT15` varchar(25) NULL COMMENT 'æ®µå€¼15', `SEGMENT16` varchar(25) NULL COMMENT 'æ®µå€¼16', `SEGMENT17` varchar(25) NULL COMMENT 'æ®µå€¼17', `SEGMENT18` varchar(25) NULL COMMENT 'æ®µå€¼18', PRIMARY KEY (`COMBINATION_ID`), UNIQUE KEY `XXGL_CODE_COMBINATIONS_U1` (`COMBINATION_ID`), KEY `XXGL_CODE_COMBINATIONS_N1` (`CODE_COMBINATION_ID`)) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8; æµ‹è¯•æ•°æ®1234567891011121314151617181920212223242526272829303132333435363738394041424344454647INSERT INTO `XXGL_CODE_COMBINATIONS` ( `CODE_COMBINATION_ID`, `ENABLED_FLAG`, `ACCOUNT_TYPE`, `SEGMENT1`, `SEGMENT2`, `SEGMENT3`, `SEGMENT4`, `SEGMENT5`, `SEGMENT6`, `SEGMENT7`, `SEGMENT8`, `SEGMENT9`, `SEGMENT10`, `SEGMENT11`, `SEGMENT12`, `SEGMENT13`, `SEGMENT14`, `SEGMENT15`, `SEGMENT16`, `SEGMENT17`, `SEGMENT18`)VALUES ( 300000003238305, 'Y', 'E', '050', '0', '71205', 'S101005', '50010', '1101', 'I101', '0', '0', '0', '0', '0', NULL, NULL, NULL, NULL, NULL, NULL ); å®žä½“ç±»ï¼ˆCodeCombinations.javaï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980import javax.persistence.GeneratedValue;import javax.persistence.Id;import org.hibernate.validator.constraints.Length;import javax.persistence.Table;import javax.validation.constraints.NotNull;/** * Created by xiaofeng.he on 2018/03/08 * å¸å·ç»„åˆDTO */@Table(name = "XXGL_CODE_COMBINATIONS")public class CodeCombinations &#123; @Id @GeneratedValue private Long combinationId; // è¡¨IDï¼Œä¸»é”®ï¼Œä¾›å…¶ä»–è¡¨åšå¤–é”® @NotNull private Long codeCombinationId; // ERPä¸­CODE_COMBINATION_ID private String accountType; private String enabledFlag; @Length(max = 25) private String segment1; @Length(max = 25) private String segment2; @Length(max = 25) private String segment3; @Length(max = 25) private String segment4; @Length(max = 25) private String segment5; @Length(max = 25) private String segment6; @Length(max = 25) private String segment7; @Length(max = 25) private String segment8; @Length(max = 25) private String segment9; @Length(max = 25) private String segment10; @Length(max = 25) private String segment11; @Length(max = 25) private String segment12; @Length(max = 25) private String segment13; @Length(max = 25) private String segment14; @Length(max = 25) private String segment15; @Length(max = 25) private String segment16; @Length(max = 25) private String segment17; @Length(max = 25) private String segment18; // getter setter...&#125; java mapper123456789101112131415161718192021222324252627282930import org.apache.ibatis.annotations.Param;/** * Created by xiaofeng.he on 2018/03/08 * è´¦æˆ·ç»„åˆmapper */public interface CodeCombinationsMapper &#123; /** * æ ¹æ®å¤šä¸ª segment value æŸ¥è¯¢å”¯ä¸€ * @param segmentValues * @return */ CodeCombinations selectOneBySegmentArray(@Param("segmentValues") String[] segmentValues); /** * æ ¹æ®å¤šä¸ª segment value æŸ¥è¯¢å”¯ä¸€ * @param segmentValues * @return */ CodeCombinations selectOneBySegmentList(List&lt;String&gt; segmentValues); /** * æ ¹æ®å¤šä¸ª segment value æŸ¥è¯¢å”¯ä¸€ * @param params * @return */ CodeCombinations selectOneBySegmentMap(Map&lt;String, Object&gt; params);&#125; xml mapper1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;&lt;mapper namespace="xxx.mapper.CodeCombinationsMapper"&gt; &lt;resultMap id="BaseResultMap" type="xxx.dto.CodeCombinations"&gt; &lt;result column="COMBINATION_ID" property="combinationId" jdbcType="DECIMAL" /&gt; &lt;result column="CODE_COMBINATION_ID" property="codeCombinationId" jdbcType="DECIMAL" /&gt; &lt;result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" /&gt; &lt;result column="ENABLED_FLAG" property="enabledFlag" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT1" property="segment1" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT2" property="segment2" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT3" property="segment3" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT4" property="segment4" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT5" property="segment5" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT6" property="segment6" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT7" property="segment7" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT8" property="segment8" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT9" property="segment9" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT10" property="segment10" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT11" property="segment11" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT12" property="segment12" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT13" property="segment13" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT14" property="segment14" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT15" property="segment15" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT16" property="segment16" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT17" property="segment17" jdbcType="VARCHAR" /&gt; &lt;result column="SEGMENT18" property="segment18" jdbcType="VARCHAR" /&gt; &lt;/resultMap&gt; &lt;!--Array:forech ä¸­çš„ collection å±žæ€§ç±»åž‹æ˜¯ Array, collection çš„å€¼å¿…é¡»æ˜¯:array, item çš„å€¼å¯ä»¥éšæ„, mapper æŽ¥å£ä¸­å‚æ•°åå­—éšæ„ --&gt; &lt;select id="selectOneBySegmentArray" resultMap="BaseResultMap"&gt; select c.* from XXGL_CODE_COMBINATIONS c &lt;where&gt; and c.ENABLED_FLAG = 'Y' &lt;choose&gt; &lt;when test="segmentValues"&gt; &lt;!-- ä½¿ç”¨äº†@Param åŽcollectionä¸èƒ½å¡«arrayï¼Œè¦å¡«å†™åˆ«å --&gt; &lt;foreach collection="segmentValues" item="segmentValue" index="index"&gt; and c.SEGMENT$&#123;index+1&#125; = #&#123;segmentValue&#125; &lt;/foreach&gt; &lt;/when&gt; &lt;otherwise&gt; and 1=2 &lt;/otherwise&gt; &lt;/choose&gt; &lt;/where&gt; &lt;/select&gt; &lt;!--List:forech ä¸­çš„ collection å±žæ€§ç±»åž‹æ˜¯ List, collection çš„å€¼å¿…é¡»æ˜¯:list, item çš„å€¼å¯ä»¥éšæ„, mapper æŽ¥å£ä¸­å‚æ•°åå­—éšæ„ --&gt; &lt;select id="selectOneBySegmentList" resultMap="BaseResultMap"&gt; select c.* from XXGL_CODE_COMBINATIONS c &lt;where&gt; and c.ENABLED_FLAG = 'Y' &lt;choose&gt; &lt;when test="list"&gt; &lt;foreach collection="list" item="segmentValue" index="index"&gt; and c.SEGMENT$&#123;index+1&#125; = #&#123;segmentValue&#125; &lt;/foreach&gt; &lt;/when&gt; &lt;otherwise&gt; and 1=2 &lt;/otherwise&gt; &lt;/choose&gt; &lt;/where&gt; &lt;/select&gt; &lt;!--Map:ä¸å•å• forech ä¸­çš„ collection å±žæ€§æ˜¯ map.key,å…¶å®ƒæ‰€æœ‰å±žæ€§éƒ½æ˜¯ map.key, æ¯”å¦‚ä¸‹é¢çš„ enabledFlag --&gt; &lt;select id="selectOneBySegmentMap" resultMap="BaseResultMap"&gt; select c.* from XXGL_CODE_COMBINATIONS c &lt;where&gt; and c.ENABLED_FLAG = #&#123;enabledFlag&#125; &lt;choose&gt; &lt;when test="segmentArray"&gt; &lt;foreach collection="segmentArray" item="segmentValue" index="index"&gt; and c.SEGMENT$&#123;index+1&#125; = #&#123;segmentValue&#125; &lt;/foreach&gt; &lt;/when&gt; &lt;otherwise&gt; and 1=2 &lt;/otherwise&gt; &lt;/choose&gt; &lt;choose&gt; &lt;when test="segmentList"&gt; &lt;foreach collection="segmentList" item="segmentValue" index="index"&gt; /* 2 */ and c.SEGMENT$&#123;index+1&#125; = #&#123;segmentValue&#125; &lt;/foreach&gt; &lt;/when&gt; &lt;otherwise&gt; and 1=2 &lt;/otherwise&gt; &lt;/choose&gt; &lt;/where&gt; &lt;/select&gt;&lt;/mapper&gt; æµ‹è¯• controller123456789101112131415161718192021222324252627282930313233import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.ResponseBody;import xxx.dto.CodeCombinations;import xxx.mapper.CodeCombinationsMapper;import java.util.Arrays;import java.util.HashMap;import java.util.List;import java.util.Map;@Controllerpublic class TestController &#123; @Autowired private CodeCombinationsMapper codeCombinationsMapper; @GetMapping("/test/code/combination/selectBySegments") @ResponseBody public List&lt;CodeCombinations&gt; test() &#123; String[] a = &#123;"050", "0", "71205", "S101005", "50010", "1101", "I101"&#125;; CodeCombinations codeCombinations1 = codeCombinationsMapper.selectOneBySegments(a); CodeCombinations codeCombinations2 = codeCombinationsMapper.selectOneBySegmentList(Arrays.asList(a)); Map&lt;String, Object&gt; params = new HashMap&lt;&gt;(); params.put("enabledFlag", "Y"); params.put("segmentArray", a); params.put("segmentList", Arrays.asList(a)); CodeCombinations codeCombinations3 = codeCombinationsMapper.selectOneBySegmentMap(params); return Arrays.asList(codeCombinations1, codeCombinations2, codeCombinations3); &#125;&#125; æµ‹è¯•ç»“æžœlog 12345678910112019-02-08 22:40:40.523 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegments - ==&gt; Preparing: select c.* from XXGL_CODE_COMBINATIONS c WHERE c.ENABLED_FLAG = 'Y' and c.SEGMENT1 = ? and c.SEGMENT2 = ? and c.SEGMENT3 = ? and c.SEGMENT4 = ? and c.SEGMENT5 = ? and c.SEGMENT6 = ? and c.SEGMENT7 = ? 2019-02-08 22:40:40.524 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegments - ==&gt; Parameters: 050(String), 0(String), 71205(String), S101005(String), 50010(String), 1101(String), I101(String)2019-02-08 22:40:40.532 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegments - &lt;== Total: 12019-02-08 22:40:43.259 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentList - ==&gt; Preparing: select c.* from XXGL_CODE_COMBINATIONS c WHERE c.ENABLED_FLAG = 'Y' and c.SEGMENT1 = ? and c.SEGMENT2 = ? and c.SEGMENT3 = ? and c.SEGMENT4 = ? and c.SEGMENT5 = ? and c.SEGMENT6 = ? and c.SEGMENT7 = ? 2019-02-08 22:40:43.259 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentList - ==&gt; Parameters: 050(String), 0(String), 71205(String), S101005(String), 50010(String), 1101(String), I101(String)2019-02-08 22:40:43.263 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentList - &lt;== Total: 12019-02-08 22:40:44.284 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentMap - ==&gt; Preparing: select c.* from XXGL_CODE_COMBINATIONS c WHERE c.ENABLED_FLAG = ? and c.SEGMENT1 = ? and c.SEGMENT2 = ? and c.SEGMENT3 = ? and c.SEGMENT4 = ? and c.SEGMENT5 = ? and c.SEGMENT6 = ? and c.SEGMENT7 = ? /* 2 */ and c.SEGMENT1 = ? /* 2 */ and c.SEGMENT2 = ? /* 2 */ and c.SEGMENT3 = ? /* 2 */ and c.SEGMENT4 = ? /* 2 */ and c.SEGMENT5 = ? /* 2 */ and c.SEGMENT6 = ? /* 2 */ and c.SEGMENT7 = ? 2019-02-08 22:40:44.284 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentMap - ==&gt; Parameters: Y(String), 050(String), 0(String), 71205(String), S101005(String), 50010(String), 1101(String), I101(String), 050(String), 0(String), 71205(String), S101005(String), 50010(String), 1101(String), I101(String)2019-02-08 22:40:44.289 DEBUG [10001] [e5c47fa7c79b461a806c2d6135d485c2] xxx.mapper.CodeCombinationsMapper.selectOneBySegmentMap - &lt;== Total: 1 json 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374[&#123;"combinationId": 1000,"codeCombinationId": 300000003238305,"accountType": "E","enabledFlag": "Y","segment1": "050","segment2": "0","segment3": "71205","segment4": "S101005","segment5": "50010","segment6": "1101","segment7": "I101","segment8": "0","segment9": "0","segment10": "0","segment11": "0","segment12": "0","segment13": null,"segment14": null,"segment15": null,"segment16": null,"segment17": null,"segment18": null&#125;,&#123;"combinationId": 1000,"codeCombinationId": 300000003238305,"accountType": "E","enabledFlag": "Y","segment1": "050","segment2": "0","segment3": "71205","segment4": "S101005","segment5": "50010","segment6": "1101","segment7": "I101","segment8": "0","segment9": "0","segment10": "0","segment11": "0","segment12": "0","segment13": null,"segment14": null,"segment15": null,"segment16": null,"segment17": null,"segment18": null&#125;,&#123;"combinationId": 1000,"codeCombinationId": 300000003238305,"accountType": "E","enabledFlag": "Y","segment1": "050","segment2": "0","segment3": "71205","segment4": "S101005","segment5": "50010","segment6": "1101","segment7": "I101","segment8": "0","segment9": "0","segment10": "0","segment11": "0","segment12": "0","segment13": null,"segment14": null,"segment15": null,"segment16": null,"segment17": null,"segment18": null&#125;] æ„Ÿè°¢https://blog.csdn.net/s592652578/article/details/52871884]]></content>
      <categories>
        <category>Java</category>
        <category>MyBatis</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èˆªå¤©ä¿¡æ¯é‡‘ç¨Žç›˜æŽ¥å£ js è°ƒç”¨]]></title>
    <url>%2F2018%2F12%2F02%2Fessay%2Fgold-tax-js%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯ æœ€è¿‘é¡¹ç›®è¦æ±‚ä¸Žå•æœºç‰ˆçš„é‡‘ç¨Žç›˜æŽ¥å£è¿›è¡Œå¯¹æŽ¥ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹è‡ªå·±çš„å¼€å‘ç»éªŒï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°æœ‰éœ€è¦çš„äºº PSï¼šæŽ¥å£ä½¿ç”¨ js å¯¹æŽ¥ï¼Œä»…æ”¯æŒ ie æµè§ˆå™¨ã€‚ å‰ç½®æ¡ä»¶åœ¨è¿›è¡Œå¼€å‘æ—¶å€™éœ€è¦æœ‰ä¸€äº›å‰ç½®æ¡ä»¶ ie æµè§ˆå™¨ å¼€å¯ activeX æŽ§ä»¶ è®¾ç½® â€“&gt; Internet é€‰é¡¹ â€“&gt; å®‰å…¨ â€“&gt; è‡ªå®šä¹‰çº§åˆ« æŠŠ activeX ç›¸å…³è®¾ç½®å‹¾ä¸Š å¯å‚è€ƒ: ç®¡ç†å‘˜èº«ä»½è¿è¡Œè°ƒè¯• å¦‚æžœå¼€ç¥¨è½¯ä»¶å®‰è£…åˆ°æœ¬åœ° Cç›˜ éœ€è¦ä½¿ç”¨ç®¡ç†å‘˜æ‰“å¼€ ie æµè§ˆå™¨ï¼Œç„¶åŽå†è¿›è¡Œè°ƒè¯• é‡‘ç¨Žç›˜å®‰è£… è¦ç¡®ä¿é‡‘ç¨Žç›˜å®‰è£…å‡†ç¡®å®‰è£…äº†TaxCardX.dll é€šç”¨ jsä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395/** èˆªä¿¡é‡‘ç¨Žç›˜ç›¸å…³function */var goldTax = &#123; /** * ä½¿ç”¨å‰å…ˆåˆ¤æ–­æ˜¯å¦æ˜¯ieæµè§ˆå™¨ * @return true/false */ isIE: function () &#123; if(!!window.ActiveXObject || "ActiveXObject" in window) return true; else return false; &#125;, /** * å¼€å¯é‡‘ç¨Žç›˜ * @param certPassword å•æœºç‰ˆä¸ºè¯ä¹¦å£ä»¤ æœåŠ¡å™¨ç‰ˆä¸ºåœ°å€ ç•™ç©ºåˆ™è¯»å–å¼€ç¥¨BINæ–‡ä»¶ä¸‹cert.txt * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx', // é”™è¯¯ä¿¡æ¯ * 'data': &#123;&#125; // æŽ¥å£è¿”å›žç›¸å…³æ•°æ® * &#125; * &lt;/pre&gt; */ openCard: function (certPassword) &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '', 'data': &#123;&#125; &#125;; try &#123; goldTax.card = new ActiveXObject("TaxCardX.GoldTax"); // å•æœºç‰ˆä¸ºè¯ä¹¦å£ä»¤ æœåŠ¡å™¨ç‰ˆä¸ºåœ°å€ ç•™ç©ºåˆ™è¯»å–å¼€ç¥¨BINæ–‡ä»¶ä¸‹cert.txt if(typeof certPassword != 'undefined') &#123; goldTax.card.CertPassword = certPassword; &#125; // å¼€å¯é‡‘ç¨Žç›˜ goldTax.card.OpenCard(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // 1011 å¼€å¯æˆåŠŸ if (result.code == 1011) &#123; result.success = true; result.data = &#123; RetCode: goldTax.card.RetCode, /* RetCode - çŠ¶æ€ç ï¼Œ 1011 å¼€å¯æˆåŠŸ */ RetMsg: goldTax.card.RetMsg, /* RetMsg çŠ¶æ€ä¿¡æ¯ */ InvLimit: goldTax.card.InvLimit, /* InvLimit â€“ å¼€ç¥¨é™é¢, é‡‘ç¨Žå¡å‘ç¥¨å¼€å…·ä»·ç¨Žåˆè®¡é™é¢ */ TaxCode: goldTax.card.TaxCode, /* TaxCode æœ¬å•ä½ç¨Žå· */ TaxClock: goldTax.card.TaxClock, /* TaxClock â€“ é‡‘ç¨Žå¡æ—¶é’Ÿ */ MachineNo: goldTax.card.MachineNo, /* MachineNo â€“ å¼€ç¥¨æœºå·ç ï¼Œä¸»å¼€ç¥¨æœºä¸º 0 */ IsInvEmpty: goldTax.card.IsInvEmpty, /* IsInvEmpty â€“ æœ‰ç¥¨æ ‡å¿—ï¼Œ0ä¸ºé‡‘ç¨Žå¡ä¸­æ— å¯å¼€å‘ç¥¨ï¼Œ1ä¸ºæœ‰ç¥¨ */ IsRepReached: goldTax.card.IsRepReached, /* IsRepReached â€“ æŠ„ç¨Žæ ‡å¿—ï¼Œ0ä¸ºæœªåˆ°æŠ„ç¨ŽæœŸï¼Œ1ä¸ºå·²åˆ°æŠ„ç¨ŽæœŸ */ IsLockReached: goldTax.card.IsLockReached, /* IsLockReached â€“ é”æ­»æ ‡å¿—ï¼Œ0ä¸ºæœªåˆ°é”æ­»æœŸï¼Œ1ä¸ºå·²åˆ°é”æ­»æœŸ */ &#125;; &#125; else &#123; result.success = false; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125;, /** * å…³é—­é‡‘ç¨Žç›˜ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx' // é”™è¯¯ä¿¡æ¯ * &#125; * &lt;/pre&gt; */ closeCard: function() &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '' &#125;; if (typeof goldTax.card != 'undefined') &#123; try &#123; goldTax.card.closeCard(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // RetCode 9000 è°ƒç”¨æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ if (result.code == 9000) &#123; result.success = true; &#125; else &#123; result.success = false; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125; &#125;, /** * æŸ¥è¯¢åº“å­˜å‘ç¥¨ * @param invKind å‘ç¥¨ç§ç±» * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx', // é”™è¯¯ä¿¡æ¯ * 'data': &#123;&#125; // æŽ¥å£è¿”å›žç›¸å…³æ•°æ® * &#125; * &lt;/pre&gt; */ invoiceInventory: function(invKind) &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '', 'data': &#123;&#125; &#125;; try &#123; if (typeof goldTax.card != 'undefined') &#123; goldTax.card.InfoKind = invKind; goldTax.card.GetInfo(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // RetCode 3011 è¯»å–æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ if (result.code == 3011) &#123; result.success = true; result.data = &#123; RetCode: goldTax.card.RetCode, /* RetCode - çŠ¶æ€ç ï¼Œ 3011 è¯»å–æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ */ RetMsg: goldTax.card.RetMsg, /* RetMsg çŠ¶æ€ä¿¡æ¯ */ InfoTypeCode: goldTax.card.InfoTypeCode, /* è¦å¼€å…·å‘ç¥¨çš„åä½ä»£ç ã€‚ä¸ºç©ºæˆ–å…¨ä¸º0æ—¶ï¼Œè¡¨ç¤ºæ— å¯ç”¨å‘ç¥¨ */ InfoNumber: goldTax.card.InfoNumber, /* è¦å¼€å…·å‘ç¥¨çš„å·ç  */ InvStock: goldTax.card.InvStock, /* å‰©ä½™çš„å¯ç”¨å‘ç¥¨ä»½æ•° */ TaxClock: goldTax.card.TaxClock /* é‡‘ç¨Žç›˜æ—¶é’Ÿ */ &#125;; &#125; else &#123; result.success = false; &#125; &#125; else &#123; result.success = false; result.code = -1; result.msg = 'Please Open Card First'; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125;, /** * å‘ç¥¨æ ¡éªŒ * @param o ä¼ å…¥å‘ç¥¨ä¿¡æ¯ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx', // é”™è¯¯ä¿¡æ¯ * 'data': &#123;&#125; // æŽ¥å£è¿”å›žç›¸å…³æ•°æ® * &#125; * &lt;/pre&gt; */ invoiceVeriferify: function(o) &#123; return goldTax.inner.invoice(1, o); &#125;, /** * å‘ç¥¨å¼€å…· * @param o ä¼ å…¥å‘ç¥¨ä¿¡æ¯ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx', // é”™è¯¯ä¿¡æ¯ * 'data': &#123;&#125; // æŽ¥å£è¿”å›žç›¸å…³æ•°æ® * &#125; * &lt;/pre&gt; */ invoicing: function(o) &#123; return goldTax.inner.invoice(0, o); &#125;, /** * å‘ç¥¨æ‰“å° * @param o ä¼ å…¥å‘ç¥¨ä¿¡æ¯ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx' // é”™è¯¯ä¿¡æ¯ * &#125; * &lt;/pre&gt; */ printInv: function(o) &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '' &#125;; try &#123; if (typeof goldTax.card != 'undefined') &#123; goldTax.card.InfoKind = o.InfoKind; /* å‘ç¥¨ç§ç±»ï¼ˆ0ï¼šä¸“ç”¨å‘ç¥¨ 2ï¼šæ™®é€šå‘ç¥¨ 11ï¼šè´§ç‰©è¿è¾“ä¸šå¢žå€¼ç¨Žä¸“ç”¨å‘ç¥¨ 12ï¼šæœºåŠ¨è½¦é”€å”®ç»Ÿä¸€å‘ç¥¨ï¼‰ */ goldTax.card.InfoTypeCode = o.InfoTypeCode; /* è¦æ‰“å°å‘ç¥¨çš„åä½ä»£ç  */ goldTax.card.InfoNumber = o.InfoNumber; /* è¦æ‰“å°å‘ç¥¨çš„å·ç  */ goldTax.card.GoodsListFlag = o.GoodsListFlag; /* é”€è´§æ¸…å•æ ‡å¿—ï¼Œ0 â€“ æ‰“å°å‘ç¥¨ï¼Œ1 â€“ æ‰“å°é”€è´§æ¸…å• */ goldTax.card.InfoShowPrtDlg = o.InfoShowPrtDlg; /* æ‰“å°æ—¶æ˜¯å¦æ˜¾ç¤ºè¾¹è·ç¡®è®¤å¯¹è¯æ¡†ï¼Œ0 â€“ ä¸å‡ºçŽ°ï¼Œ1 â€“ å‡ºçŽ° */ // è°ƒç”¨æŽ¥å£ goldTax.card.PrintInv(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // RetCode 5011 æ‰“å°æˆåŠŸï¼Œ5001 â€“ æœªæ‰¾åˆ°å‘ç¥¨æˆ–æ¸…å•ï¼Œ5012 â€“ æœªæ‰“å°ï¼Œ5013 â€“ æ‰“å°å¤±è´¥ if (result.code == 5011) &#123; result.success = true; &#125; else &#123; result.success = false; &#125; &#125; else &#123; result.success = false; result.code = -1; result.msg = 'Please Open Card First'; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125;, /** * å·²å¼€å‘ç¥¨ä½œåºŸ * @param o ä¼ å…¥å‘ç¥¨ä¿¡æ¯ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx' // é”™è¯¯ä¿¡æ¯ * &#125; * &lt;/pre&gt; */ cancelInv: function(o) &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '' &#125;; try &#123; if (typeof goldTax.card != 'undefined') &#123; goldTax.card.InfoKind = o.InfoKind; /* å‘ç¥¨ç§ç±»ï¼ˆ0ï¼šä¸“ç”¨å‘ç¥¨ 2ï¼šæ™®é€šå‘ç¥¨ 11ï¼šè´§ç‰©è¿è¾“ä¸šå¢žå€¼ç¨Žä¸“ç”¨å‘ç¥¨ 12ï¼šæœºåŠ¨è½¦é”€å”®ç»Ÿä¸€å‘ç¥¨ï¼‰ */ goldTax.card.InfoTypeCode = o.InfoTypeCode; /* è¦ä½œåºŸå‘ç¥¨çš„åä½æˆ–åäºŒä½ä»£ç  */ goldTax.card.InfoNumber = o.InfoNumber; /* è¦ä½œåºŸå‘ç¥¨çš„å·ç  */ // è°ƒç”¨æŽ¥å£ goldTax.card.CancelInv(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // RetCode 6011 æ‰“å°æˆåŠŸï¼Œ6001 â€“ å½“æœˆå‘ç¥¨åº“æœªæ‰¾åˆ°è¯¥å‘ç¥¨ï¼Œ6002 â€“ è¯¥å‘ç¥¨å·²ç»ä½œåºŸï¼Œ6012 â€“ ä½œåºŸå¤±è´¥ï¼Œ6013 â€“ ä½œåºŸå¤±è´¥(å¼‚å¸¸) if (result.code == 6011) &#123; result.success = true; &#125; else &#123; result.success = false; &#125; &#125; else &#123; result.success = false; result.code = -1; result.msg = 'Please Open Card First'; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125;, // å†…éƒ¨æ–¹æ³• inner: &#123; /** * invoice æŽ¥å£ * @param checkEWM é»˜è®¤ä¸º0ï¼ˆ0: å‘ç¥¨å¼€å…·, 1: å‘ç¥¨æ ¡éªŒ, 2: ç©ºç™½ä½œåºŸ) * @param o ä¼ å…¥å‘ç¥¨ä¿¡æ¯ * @return * &lt;pre&gt; * &#123; * 'success': true/false, // æˆåŠŸæˆ–è€…å¤±è´¥ * 'code': -1/å…¶ä»–, // é”™è¯¯ç ï¼Œ-1 ä¸ºç³»ç»Ÿé”™è¯¯ * 'msg': 'xxx', // é”™è¯¯ä¿¡æ¯ * 'data': &#123;&#125; // æŽ¥å£è¿”å›žç›¸å…³æ•°æ® * &#125; * &lt;/pre&gt; */ invoice: function(checkEWM, o) &#123; var result = &#123; 'success': false, 'code': -1, 'msg': '', 'data': &#123;&#125; &#125;; try &#123; if (typeof goldTax.card != 'undefined') &#123; // CheckEWMå€¼é»˜è®¤ä¸º0ï¼ˆä¸º1æ—¶ç”¨äºŽå‘ç¥¨æ ¡éªŒã€‚ // æ³¨æ„ï¼šä¸€æ—¦CheckEWMå€¼ç½®1ç”¨äºŽå‘ç¥¨æ ¡éªŒä¹‹åŽï¼Œ //å¦‚æžœè¦å†è¿›è¡Œå‘ç¥¨å¼€å…·å¿…é¡»æ‰‹åŠ¨å°†CheckEWMå€¼ç½®ä¸º0ï¼Œå¦åˆ™Invoice()æ–¹æ³•çš„åŠŸèƒ½å°†ä¸€ç›´å¤„äºŽå‘ç¥¨æ ¡éªŒçŠ¶æ€ï¼‰ goldTax.card.CheckEWM = checkEWM; goldTax.card.InvInfoInit(); /* åˆå§‹åŒ–å‘ç¥¨æŠ¬å¤´ä¿¡æ¯ */ goldTax.card.InfoKind = o.InfoKind; /* å¢žå€¼ç¨Žæ™®é€šå‘ç¥¨2 ä¸“ç¥¨0 */ goldTax.card.InfoClientName = o.InfoClientName; /* è´­æ–¹åç§° */ goldTax.card.InfoClientTaxCode = o.InfoClientTaxCode; /* è´­æ–¹ç¨Žå· */ goldTax.card.InfoClientBankAccount = o.InfoClientBankAccount; /* è´­æ–¹å¼€æˆ·è¡ŒåŠè´¦å· */ goldTax.card.InfoClientAddressPhone = o.InfoClientAddressPhone; /* è´­æ–¹åœ°å€ç”µè¯ */ goldTax.card.InfoSellerBankAccount = o.InfoSellerBankAccount; /* é”€æ–¹å¼€æˆ·è¡ŒåŠè´¦å· */ goldTax.card.InfoSellerAddressPhone = o.InfoSellerAddressPhone; /* é”€æ–¹åœ°å€ç”µè¯ */ // å¦‚æžœæ˜¯å¤šå•†å“å¤šç¨ŽçŽ‡ ç¨ŽçŽ‡åº”è¯¥æ”¾åˆ°ä¸‹é¢å•†å“ä¿¡æ¯å¾ªçŽ¯é‡Œ if (typeof o.InfoTaxRate != 'undefined' &amp;&amp; o.InfoTaxRate) &#123; goldTax.card.InfoTaxRate = o.InfoTaxRate; /* ç¨ŽçŽ‡,(å·²æŽˆæƒçš„ç¨ŽçŽ‡ï¼Œ 17% ä¼ 17) */ &#125; goldTax.card.InfoNotes = o.InfoNotes; /* å¤‡æ³¨ */ goldTax.card.InfoInvoicer = o.InfoInvoicer; /* å¼€ç¥¨äºº */ // å¤æ ¸äººï¼Œå¯ä¸ºç©º if (typeof o.InfoChecker != 'undefined' &amp;&amp; o.InfoChecker) &#123; goldTax.card.InfoChecker = o.InfoChecker; &#125; // æ”¶æ¬¾äººï¼Œå¯ä¸ºç©º if (typeof o.InfoCashier != 'undefined' &amp;&amp; o.InfoCashier) &#123; goldTax.card.InfoCashier = o.InfoCashier; &#125; // å¦‚ä¸ä¸ºç©ºï¼Œåˆ™å¼€å…·é”€è´§æ¸…å•ï¼Œæ­¤ä¸ºå‘ç¥¨ä¸Šå•†å“åç§°æ çš„æ¸…å•ä¿¡æ¯ï¼Œåº”ä¸ºâ€œ(è¯¦è§é”€è´§æ¸…å•)â€å­—æ · if (typeof o.InfoListName != 'undefined' &amp;&amp; o.InfoListName) &#123; goldTax.card.InfoListName = o.InfoListName; &#125; // æ¸…ç©ºå•†å“æ˜Žç»†åˆ—è¡¨ goldTax.card.ClearInvList(); // éåŽ†è¡Œ $.each(o.InvList, function(i, v) &#123; goldTax.card.InvListInit(); /* åˆå§‹åŒ–å‘ç¥¨æ˜Žç»†ä¿¡æ¯å„é¡¹å±žæ€§ */ goldTax.card.ListGoodsName = v.ListGoodsName; /* å•†å“æˆ–åŠ³åŠ¡åç§° */ goldTax.card.ListTaxItem = v.ListTaxItem; /* ç¨Žç›®ï¼Œ4ä½æ•°å­—ï¼Œå•†å“æ‰€å±žç±»åˆ« */ goldTax.card.ListStandard = v.ListStandard; /* è§„æ ¼åž‹å· */ // è®¡é‡å•ä½ï¼Œå¦‚è®¡é‡å•ä½ä¸ºç©ºï¼Œåˆ™å¿½ç•¥æ•°é‡å’Œå•ä»· if (typeof v.ListUnit != 'undefined' &amp;&amp; v.ListUnit) &#123; goldTax.card.ListUnit = v.ListUnit; &#125; // å»ºè®®ä¼ å…¥æ•°é‡å’Œå«ç¨Žå•ä»·æˆ–å«ç¨Žé‡‘é¢ ç”±æŽ¥å£è®¡ç®—å¸¦å°æ•°çš„ç¨Žé¢ è§„é¿è¯¯å·® goldTax.card.ListNumber = v.ListNumber; // æ•°é‡ goldTax.card.ListPrice = v.ListPrice; // å•ä»· // é‡‘é¢ï¼Œå¯ä»¥ä¸ä¼ (ä¸º0)ï¼Œç”±æŽ¥å£è½¯ä»¶è®¡ç®—ï¼Œå¦‚ä¼ å…¥åˆ™åº”ç¬¦åˆè®¡ç®—å…³ç³» if (typeof v.ListAmount != 'undefined' &amp;&amp; v.ListAmount ) &#123; goldTax.card.ListAmount = v.ListAmount; &#125; goldTax.card.ListPriceKind = v.ListPriceKind; /* å«ç¨Žä»·æ ‡å¿—ï¼Œå•ä»·å’Œé‡‘é¢çš„ç§ç±»ï¼Œ 0ä¸ºä¸å«ç¨Žä»·ï¼Œ1ä¸ºå«ç¨Žä»· */ // ç¨Žé¢å¯ä»¥ä¸ä¼ (ä¸º0)ï¼Œç”±æŽ¥å£è½¯ä»¶è®¡ç®—ï¼Œå¦‚ä¼ å…¥åˆ™åº”ç¬¦åˆè®¡ç®—å…³ç³» if (typeof v.ListTaxAmount != 'undefined' &amp;&amp; v.ListTaxAmount) &#123; goldTax.card.ListTaxAmount = v.ListTaxAmount; &#125; // æ·»åŠ ä¸€è¡Œ goldTax.card.AddInvList(); &#125;); // è°ƒç”¨æŽ¥å£ goldTax.card.Invoice(); result.code = goldTax.card.RetCode; result.msg = goldTax.card.RetMsg; // RetCode 4011 å¼€ç¥¨æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ if (result.code == 4011) &#123; result.success = true; result.data = &#123; RetCode: goldTax.card.RetCode, /* RetCode - çŠ¶æ€ç ï¼Œ 3011 è¯»å–æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ */ RetMsg: goldTax.card.RetMsg, /* RetMsg çŠ¶æ€ä¿¡æ¯ */ InfoAmount: goldTax.card.InfoAmount , /* åˆè®¡ä¸å«ç¨Žé‡‘é¢ */ InfoTaxAmount: goldTax.card.InfoTaxAmount, /* åˆè®¡ç¨Žé¢ */ InfoInvDate: goldTax.card.InfoInvDate, /* å¼€ç¥¨æ—¥æœŸ */ InfMonth: goldTax.card.InfMonth, /* æ‰€å±žæœˆä»½ */ InfoTypeCode: goldTax.card.InfoTypeCode, /* å‘ç¥¨åä½ä»£ç  */ InfoNumber: goldTax.card.InfoNumber, /* å‘ç¥¨å·ç  */ GoodsListFlag: goldTax.card.GoodsListFlag /* é”€è´§æ¸…å•æ ‡å¿—ï¼Œ0 â€“ æ— é”€è´§æ¸…å•ï¼Œ1 â€“ æœ‰é”€è´§æ¸…å• */ &#125;; &#125; else &#123; result.success = false; &#125; &#125; else &#123; result.success = false; result.code = -1; result.msg = 'Please Open Card First'; &#125; &#125; catch (e) &#123; result.success = false; result.code = -1; result.msg = 'ActiveX Error, ' + e.description; &#125; return result; &#125; &#125;&#125;; ç›¸å…³èµ„æ–™CSDN éœ€è¦ç§¯åˆ†ä¸‹è½½ é‡‘ç¨Ž é˜²ä¼ªç¨ŽæŽ§ ç»„ä»¶æŽ¥å£ å¼€å‘æ–‡æ¡£ ä»£ç æ¡ˆä¾‹ æ²¡æœ‰ç§¯åˆ†çš„ æˆ³è¿™é‡Œ]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>ActiveX</tag>
        <tag>é‡‘ç¨Ž</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F08%2F20%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
